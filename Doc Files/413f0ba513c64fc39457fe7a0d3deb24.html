<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>52bfde655a464a118eedbf2b9c5df38d</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1"
data-executionInfo="{&quot;elapsed&quot;:13,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944060821,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="H7HxxAcpddq7">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from google.colab import drive</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># drive.mount(&#39;/content/drive&#39;)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="145"
data-executionInfo="{&quot;elapsed&quot;:505,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674948879226,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="fqvpOfk8cr0Y">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install skimpy</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="146"
data-executionInfo="{&quot;elapsed&quot;:570,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674948884531,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="4PwUnUW9xrwu">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pip install cmfrec</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4"
data-executionInfo="{&quot;elapsed&quot;:61,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944069437,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="9Y71HKn-RaMO">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmfrec</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5"
data-executionInfo="{&quot;elapsed&quot;:58,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944069438,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="XEY_wvCacs4d">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6"
data-executionInfo="{&quot;elapsed&quot;:835,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944070217,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="uY8FcL2js2v6">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7"
data-executionInfo="{&quot;elapsed&quot;:2073,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944072270,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="CHCdI8hucs7o">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datasets</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/MyDrive/Scaler/datasets/zee rat.csv&#39;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/MyDrive/Scaler/datasets/zee user.csv&#39;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/MyDrive/Scaler/datasets/zee movie.csv&#39;</span>,encoding<span class="op">=</span><span class="st">&#39;ISO-8859-1&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:68}"
data-executionInfo="{&quot;elapsed&quot;:135,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944072272,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="wE6Kf0ZLcs-J" data-outputId="8aec3d03-5f82-474b-c9b9-c700984ede1b">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cleaning column names</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skimpy <span class="im">import</span> clean_columns</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> clean_columns(movies, case <span class="op">=</span> <span class="st">&#39;snake&#39;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> clean_columns(ratings, case <span class="op">=</span> <span class="st">&#39;snake&#39;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> clean_columns(users, case <span class="op">=</span> <span class="st">&#39;snake&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span> column names have been cleaned
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span> column names have been cleaned
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span> column names have been cleaned
</pre>

</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:132,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944072274,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="hH8a6G0KctAq" data-outputId="c7980f4c-c49d-4f5e-e5b7-044b6ef2fea0">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding shapes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ratings.shape,movies.shape,users.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>((1000209, 4), (3883, 3), (6040, 5))</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:74,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944072276,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="ie4a4xINzURK" data-outputId="dd2ed530-e958-4d38-d1ea-0d97e69b6559">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ratings.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ratings.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<pre><code>user_id      0
movie_id     0
rating       0
timestamp    0
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11"
data-executionInfo="{&quot;elapsed&quot;:3509,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944075745,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="JjS0cFk9ctDh">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># converting timestamps to datetime format</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ratings[<span class="st">&#39;date&#39;</span>] <span class="op">=</span> [datetime.fromtimestamp(i).strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">-%m-%Y&#39;</span>) <span class="cf">for</span> i <span class="kw">in</span> ratings.timestamp]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ratings[<span class="st">&#39;hours&#39;</span>] <span class="op">=</span> ratings[<span class="st">&#39;timestamp&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: datetime.fromtimestamp(x).hour)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="12"
data-executionInfo="{&quot;elapsed&quot;:607,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944076347,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="r6G2ZHNCOp9-">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ratings[<span class="st">&#39;date&#39;</span>] <span class="op">=</span> ratings[<span class="st">&#39;date&#39;</span>].astype(np.datetime64)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:71,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944076349,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="CpWOVs_QfoYU" data-outputId="d9d49d2b-9f53-4502-9fd4-762829e89e64">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding nuniques()</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;_&#39;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;RATINGS NUNIQUES&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> ratings:</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i ,<span class="st">&#39;:&#39;</span>,ratings[i].nunique())</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;_&#39;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;MOVIES NUNIQUES&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> movies:</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i ,<span class="st">&#39;:&#39;</span>,movies[i].nunique())</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;_&#39;</span><span class="op">*</span><span class="dv">40</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;USERS NUNIQUES&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> users:</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i ,<span class="st">&#39;:&#39;</span>,users[i].nunique())</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;_&#39;</span><span class="op">*</span><span class="dv">40</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>________________________________________
RATINGS NUNIQUES 

user_id : 6040
movie_id : 3706
rating : 5
timestamp : 458455
date : 1040
hours : 24
________________________________________
MOVIES NUNIQUES 

movie_id : 3883
title : 3883
genres : 301
________________________________________
USERS NUNIQUES 

user_id : 6040
gender : 2
age : 7
occupation : 21
zip_code : 3439
________________________________________
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:23,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944076353,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="1mCToVBAfobW" data-outputId="44ef7316-ff91-4682-a768-58a2f889e9d7">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding missing values</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ratings.isnull().<span class="bu">sum</span>(), movies.isnull().<span class="bu">sum</span>(), users.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>(user_id      0
 movie_id     0
 rating       0
 timestamp    0
 date         0
 hours        0
 dtype: int64,
 movie_id    0
 title       0
 genres      0
 dtype: int64,
 user_id       0
 gender        0
 age           0
 occupation    0
 zip_code      0
 dtype: int64)</code></pre>
</div>
</div>
<div class="cell markdown" id="ymaLhQKFiHYC">
<p><strong><em>No missing values found in all three
datasets</em></strong></p>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:823,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944077165,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="kyc5rzoxfoeF" data-outputId="6d7bd01d-d706-40c9-9ccb-1bc9e4b3d6f3">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding duplicates</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ratings.duplicated().<span class="bu">sum</span>(),movies.duplicated().<span class="bu">sum</span>(),users.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<pre><code>(0, 0, 0)</code></pre>
</div>
</div>
<div class="cell markdown" id="dpOMCcBkiekZ">
<p><strong><em>ratings dataset has 24 duplicate rows</em></strong></p>
</div>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:37,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944077170,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="dk65JrCLfogn" data-outputId="40310217-151d-43de-a212-97e6a33e06e0">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># removing duplicates </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ratings.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ratings.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell markdown" id="nitbtDWyirby">
<hr />
<p><strong><strong><em>DESCRIBE AND INFO</em></strong></strong></p>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:1310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078457,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="RXykId9OfojL" data-outputId="22612afc-1d1d-4812-f229-a2083877f5b9">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;RATINGS INFO AND DESCRIBE&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format<span class="op">=</span><span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ratings.describe(),ratings.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>RATINGS INFO AND DESCRIBE 

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 1000209 entries, 0 to 1000208
Data columns (total 6 columns):
 #   Column     Non-Null Count    Dtype         
---  ------     --------------    -----         
 0   user_id    1000209 non-null  int64         
 1   movie_id   1000209 non-null  int64         
 2   rating     1000209 non-null  int64         
 3   timestamp  1000209 non-null  int64         
 4   date       1000209 non-null  datetime64[ns]
 5   hours      1000209 non-null  int64         
dtypes: datetime64[ns](1), int64(5)
memory usage: 53.4 MB
</code></pre>
</div>
<div class="output execute_result" data-execution_count="17">
<pre><code>(         user_id   movie_id     rating     timestamp      hours
 count 1000209.00 1000209.00 1000209.00    1000209.00 1000209.00
 mean     3024.51    1865.54       3.58  972243695.40      11.92
 std      1728.41    1096.04       1.12   12152558.94       7.89
 min         1.00       1.00       1.00  956703932.00       0.00
 25%      1506.00    1030.00       3.00  965302637.00       4.00
 50%      3070.00    1835.00       4.00  973018006.00      14.00
 75%      4476.00    2770.00       4.00  975220939.00      19.00
 max      6040.00    3952.00       5.00 1046454590.00      23.00,
 None)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:178,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078458,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="CsVvSSD1fol0" data-outputId="5e85a1b8-ab11-4dc0-e5b6-3af3249b9c23">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ratings.describe(include <span class="op">=</span> np.number, percentiles<span class="op">=</span>[<span class="fl">.10</span>,<span class="fl">.25</span>,<span class="fl">.75</span>,<span class="fl">.90</span>,<span class="fl">.95</span>, <span class="fl">.99</span>]).<span class="bu">round</span>(<span class="dv">2</span>).T.astype(<span class="bu">int</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-ffdee12f-dda6-4245-bcf0-1ac3c639e206">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>10%</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>90%</th>
      <th>95%</th>
      <th>99%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user_id</th>
      <td>1000209</td>
      <td>3024</td>
      <td>1728</td>
      <td>1</td>
      <td>669</td>
      <td>1506</td>
      <td>3070</td>
      <td>4476</td>
      <td>5443</td>
      <td>5740</td>
      <td>5978</td>
      <td>6040</td>
    </tr>
    <tr>
      <th>movie_id</th>
      <td>1000209</td>
      <td>1865</td>
      <td>1096</td>
      <td>1</td>
      <td>357</td>
      <td>1030</td>
      <td>1835</td>
      <td>2770</td>
      <td>3430</td>
      <td>3675</td>
      <td>3871</td>
      <td>3952</td>
    </tr>
    <tr>
      <th>rating</th>
      <td>1000209</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>timestamp</th>
      <td>1000209</td>
      <td>972243695</td>
      <td>12152558</td>
      <td>956703932</td>
      <td>960681570</td>
      <td>965302637</td>
      <td>973018006</td>
      <td>975220939</td>
      <td>978133376</td>
      <td>993074152</td>
      <td>1029360403</td>
      <td>1046454590</td>
    </tr>
    <tr>
      <th>hours</th>
      <td>1000209</td>
      <td>11</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>14</td>
      <td>19</td>
      <td>22</td>
      <td>23</td>
      <td>23</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ffdee12f-dda6-4245-bcf0-1ac3c639e206')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ffdee12f-dda6-4245-bcf0-1ac3c639e206 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ffdee12f-dda6-4245-bcf0-1ac3c639e206');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="m8ZDHvxwi0ry">
<hr />
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:209,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078498,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="vNCW0fYQfooj" data-outputId="f616d728-f66c-490e-cc9e-02400ea6891d">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;MOVIES INFO AND DESCRIBE&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format<span class="op">=</span><span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>movies.describe(),movies.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>MOVIES INFO AND DESCRIBE 

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3883 entries, 0 to 3882
Data columns (total 3 columns):
 #   Column    Non-Null Count  Dtype 
---  ------    --------------  ----- 
 0   movie_id  3883 non-null   int64 
 1   title     3883 non-null   object
 2   genres    3883 non-null   object
dtypes: int64(1), object(2)
memory usage: 91.1+ KB
</code></pre>
</div>
<div class="output execute_result" data-execution_count="19">
<pre><code>(       movie_id
 count   3883.00
 mean    1986.05
 std     1146.78
 min        1.00
 25%      982.50
 50%     2010.00
 75%     2980.50
 max     3952.00,
 None)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
data-executionInfo="{&quot;elapsed&quot;:194,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078500,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="KV0W33MeforJ" data-outputId="7b451fb8-a983-42a6-9973-1fbed85ea5a4">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>movies.describe(include<span class="op">=</span><span class="bu">object</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-daa8e320-0b37-4e52-954c-b8c5af76aa0f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3883</td>
      <td>3883</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>3883</td>
      <td>301</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Toy Story (1995)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>843</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-daa8e320-0b37-4e52-954c-b8c5af76aa0f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-daa8e320-0b37-4e52-954c-b8c5af76aa0f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-daa8e320-0b37-4e52-954c-b8c5af76aa0f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
data-executionInfo="{&quot;elapsed&quot;:192,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078501,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="jDo5VMtWfot1" data-outputId="396887c8-fc90-4993-b7a0-f1cc4f3abcd4">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>movies.describe(include <span class="op">=</span> np.number, percentiles<span class="op">=</span>[<span class="fl">.10</span>,<span class="fl">.25</span>,<span class="fl">.75</span>,<span class="fl">.90</span>,<span class="fl">.95</span>, <span class="fl">.99</span>]).<span class="bu">round</span>(<span class="dv">2</span>).T.astype(<span class="bu">int</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">

  <div id="df-9c8b7024-ed48-4344-8db4-7d3f1a8c43d8">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>10%</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>90%</th>
      <th>95%</th>
      <th>99%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>movie_id</th>
      <td>3883</td>
      <td>1986</td>
      <td>1146</td>
      <td>1</td>
      <td>392</td>
      <td>982</td>
      <td>2010</td>
      <td>2980</td>
      <td>3562</td>
      <td>3756</td>
      <td>3913</td>
      <td>3952</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9c8b7024-ed48-4344-8db4-7d3f1a8c43d8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9c8b7024-ed48-4344-8db4-7d3f1a8c43d8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9c8b7024-ed48-4344-8db4-7d3f1a8c43d8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="bk9UQQ4vi86x">
<hr />
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:191,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078503,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="rThJfDnifowq" data-outputId="c4f4c365-5fae-4fb7-bdd0-30f2b21de2b8">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;USERS INFO AND DESCRIBE&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format<span class="op">=</span><span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>users.describe(),users.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>USERS INFO AND DESCRIBE 

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6040 entries, 0 to 6039
Data columns (total 5 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   user_id     6040 non-null   int64 
 1   gender      6040 non-null   object
 2   age         6040 non-null   int64 
 3   occupation  6040 non-null   int64 
 4   zip_code    6040 non-null   object
dtypes: int64(3), object(2)
memory usage: 236.1+ KB
</code></pre>
</div>
<div class="output execute_result" data-execution_count="22">
<pre><code>(       user_id     age  occupation
 count  6040.00 6040.00     6040.00
 mean   3020.50   30.64        8.15
 std    1743.74   12.90        6.33
 min       1.00    1.00        0.00
 25%    1510.75   25.00        3.00
 50%    3020.50   25.00        7.00
 75%    4530.25   35.00       14.00
 max    6040.00   56.00       20.00,
 None)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
data-executionInfo="{&quot;elapsed&quot;:158,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078505,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Y8ALVCRKfozv" data-outputId="32947c9a-a837-4842-da4b-54d4c26727da">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>users.describe(include<span class="op">=</span><span class="bu">object</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">

  <div id="df-a278fb0b-da72-4b84-bf9a-ae5e3caeab8f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>zip_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6040</td>
      <td>6040</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>3439</td>
    </tr>
    <tr>
      <th>top</th>
      <td>M</td>
      <td>48104</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4331</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a278fb0b-da72-4b84-bf9a-ae5e3caeab8f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a278fb0b-da72-4b84-bf9a-ae5e3caeab8f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a278fb0b-da72-4b84-bf9a-ae5e3caeab8f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:143}"
data-executionInfo="{&quot;elapsed&quot;:161,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078511,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="AfHYu-qvfo2k" data-outputId="264e0ca7-84aa-4fa4-f285-9468eccaefc3">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>users.describe(include <span class="op">=</span> np.number, percentiles<span class="op">=</span>[<span class="fl">.10</span>,<span class="fl">.25</span>,<span class="fl">.75</span>,<span class="fl">.90</span>,<span class="fl">.95</span>, <span class="fl">.99</span>]).<span class="bu">round</span>(<span class="dv">2</span>).T.astype(<span class="bu">int</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">

  <div id="df-18e21dfd-c13c-4b8b-9bc6-e6da7e60927e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>10%</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>90%</th>
      <th>95%</th>
      <th>99%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user_id</th>
      <td>6040</td>
      <td>3020</td>
      <td>1743</td>
      <td>1</td>
      <td>604</td>
      <td>1510</td>
      <td>3020</td>
      <td>4530</td>
      <td>5436</td>
      <td>5738</td>
      <td>5979</td>
      <td>6040</td>
    </tr>
    <tr>
      <th>age</th>
      <td>6040</td>
      <td>30</td>
      <td>12</td>
      <td>1</td>
      <td>18</td>
      <td>25</td>
      <td>25</td>
      <td>35</td>
      <td>50</td>
      <td>56</td>
      <td>56</td>
      <td>56</td>
    </tr>
    <tr>
      <th>occupation</th>
      <td>6040</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>14</td>
      <td>17</td>
      <td>19</td>
      <td>20</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-18e21dfd-c13c-4b8b-9bc6-e6da7e60927e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-18e21dfd-c13c-4b8b-9bc6-e6da7e60927e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-18e21dfd-c13c-4b8b-9bc6-e6da7e60927e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="KAeRQwWejGFx">
<p><strong><strong><em>DESCRIBE AND INFO ENDS</em></strong></strong></p>
<hr />
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:155,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078512,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="9qq-o9Zxfo5g" data-outputId="7b1b499d-8c93-4fb9-a9d2-769bbdc9674c">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ratings.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">

  <div id="df-4fdf091d-34eb-47f9-9941-98495ddecb45">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
      <td>2001-06-01</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4fdf091d-34eb-47f9-9941-98495ddecb45')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4fdf091d-34eb-47f9-9941-98495ddecb45 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4fdf091d-34eb-47f9-9941-98495ddecb45');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:153,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078513,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="-3DO7f3ffo8j" data-outputId="4fd50fae-cafc-4e7d-8888-1a2c48fabe41">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>movies.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">

  <div id="df-f420626d-e796-48de-ab9a-09151438fefc">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_id</th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f420626d-e796-48de-ab9a-09151438fefc')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f420626d-e796-48de-ab9a-09151438fefc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f420626d-e796-48de-ab9a-09151438fefc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="27"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:152,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078515,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="GPkZ8wNtfo_X" data-outputId="1b138248-adbb-4dd4-bcf9-7f074d8439ae">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>users.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="27">

  <div id="df-fa8e89fe-501f-401f-98bf-96deebf2daf7">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>M</td>
      <td>25</td>
      <td>15</td>
      <td>55117</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>M</td>
      <td>45</td>
      <td>7</td>
      <td>2460</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>M</td>
      <td>25</td>
      <td>20</td>
      <td>55455</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fa8e89fe-501f-401f-98bf-96deebf2daf7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fa8e89fe-501f-401f-98bf-96deebf2daf7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fa8e89fe-501f-401f-98bf-96deebf2daf7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="28"
data-executionInfo="{&quot;elapsed&quot;:151,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944078516,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="1xIBAviUfpBs">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merging all three datasets</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ratings.merge(users,on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.merge(movies,on<span class="op">=</span><span class="st">&#39;movie_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="29"
data-executionInfo="{&quot;elapsed&quot;:6161,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944085533,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="XNtnAPcoRTB_">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating new feature release year</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;release_year&#39;</span>]  <span class="op">=</span> df[<span class="st">&#39;title&#39;</span>].<span class="bu">str</span>.extract(<span class="vs">r&#39;([\d]+)&#39;</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;title&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;title&#39;</span>].replace(<span class="st">&#39;[0-9]&#39;</span>,<span class="st">&#39;&#39;</span>,regex<span class="op">=</span><span class="va">True</span>).<span class="bu">str</span>.strip(<span class="st">&#39;()&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="30"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944085534,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="YM_SKb6MQtcR">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;release_year&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;release_year&#39;</span>].astype(<span class="bu">int</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="31"
data-executionInfo="{&quot;elapsed&quot;:840,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944086367,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Rh6LW88mQY6O">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">&#39;release_year&#39;</span>].between(df[<span class="st">&#39;release_year&#39;</span>].quantile(<span class="fl">.04</span>),</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                                   df[<span class="st">&#39;release_year&#39;</span>].quantile(<span class="fl">.999</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                                   inclusive<span class="op">=</span><span class="va">True</span>)]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="32"
data-executionInfo="{&quot;elapsed&quot;:1988,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944088351,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="lxcjnXq1RRwY">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;title&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;title&#39;</span>].<span class="bu">str</span>.lstrip(<span class="st">&#39;(&#39;</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;title&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;title&#39;</span>].<span class="bu">str</span>.lstrip(<span class="st">&#39;)&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:78,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944088353,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="xln__FfmfpIL" data-outputId="55a3b2fe-67a0-46fe-e8f8-c863d55cb01c">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<pre><code>(959268, 13)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:57,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944088355,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="CeJPOUOzfpEt" data-outputId="5dbd7900-2126-4b40-c870-07e4e708cc21">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="34">

  <div id="df-5f66f142-0f62-4217-a023-b240e409f39d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>2000-12-31</td>
      <td>22</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>2000-12-31</td>
      <td>21</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>2000-12-30</td>
      <td>23</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>2000-12-30</td>
      <td>18</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5f66f142-0f62-4217-a023-b240e409f39d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5f66f142-0f62-4217-a023-b240e409f39d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5f66f142-0f62-4217-a023-b240e409f39d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="35"
data-executionInfo="{&quot;elapsed&quot;:55,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944088357,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="nNep2aUaIr3H">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">&#39;age&#39;</span>].between(df[<span class="st">&#39;age&#39;</span>].quantile(<span class="fl">.03</span>),</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                                   df[<span class="st">&#39;age&#39;</span>].quantile(<span class="dv">1</span>),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                                   inclusive<span class="op">=</span><span class="va">True</span>)]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:58,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944088361,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="fkTDoP2cKP9C" data-outputId="d122f294-b933-480c-ddda-f2ad85e0e0f1">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="36">

  <div id="df-7e73c0d7-5cfa-4681-822e-d75b237a6596">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>2000-12-31</td>
      <td>21</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>2000-12-30</td>
      <td>23</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>2000-12-30</td>
      <td>18</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>1193</td>
      <td>4</td>
      <td>978156168</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>F</td>
      <td>18</td>
      <td>3</td>
      <td>95825</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7e73c0d7-5cfa-4681-822e-d75b237a6596')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7e73c0d7-5cfa-4681-822e-d75b237a6596 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7e73c0d7-5cfa-4681-822e-d75b237a6596');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="apriori-algorithm" class="cell markdown" id="VwsVFN9BnqTl">
<h3><strong><em>Apriori</em></strong>
<strong><em>Algorithm</em></strong></h3>
</section>
<section id="recommendations-according-to-movie-title"
class="cell markdown" id="5fQoZrSr5tAr">
<h4><strong><em>Recommendations according to movie
title</em></strong></h4>
</section>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:641}"
data-executionInfo="{&quot;elapsed&quot;:56,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944088362,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="yOJcty3DTx09" data-outputId="d29dd06f-394b-42dd-a7df-a34e790c0542">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">

  <div id="df-b68f0836-f232-48ea-bb76-79425cc3871f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>2000-12-31</td>
      <td>21</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>2000-12-30</td>
      <td>23</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>2000-12-30</td>
      <td>18</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>1193</td>
      <td>4</td>
      <td>978156168</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>F</td>
      <td>18</td>
      <td>3</td>
      <td>95825</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000204</th>
      <td>5949</td>
      <td>2198</td>
      <td>5</td>
      <td>958846401</td>
      <td>2000-05-20</td>
      <td>18</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>47901</td>
      <td>Modulations</td>
      <td>Documentary</td>
      <td>1998</td>
    </tr>
    <tr>
      <th>1000205</th>
      <td>5675</td>
      <td>2703</td>
      <td>3</td>
      <td>976029116</td>
      <td>2000-05-12</td>
      <td>15</td>
      <td>M</td>
      <td>35</td>
      <td>14</td>
      <td>30030</td>
      <td>Broken Vessels</td>
      <td>Drama</td>
      <td>1998</td>
    </tr>
    <tr>
      <th>1000206</th>
      <td>5780</td>
      <td>2845</td>
      <td>1</td>
      <td>958153068</td>
      <td>2000-12-05</td>
      <td>17</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>92886</td>
      <td>White Boys</td>
      <td>Drama</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Comedy|Drama|Western</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000208</th>
      <td>5938</td>
      <td>2909</td>
      <td>4</td>
      <td>957273353</td>
      <td>2000-02-05</td>
      <td>13</td>
      <td>M</td>
      <td>25</td>
      <td>1</td>
      <td>35401</td>
      <td>Five Wives, Three Secretaries and Me</td>
      <td>Documentary</td>
      <td>1998</td>
    </tr>
  </tbody>
</table>
<p>933429 rows  13 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b68f0836-f232-48ea-bb76-79425cc3871f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b68f0836-f232-48ea-bb76-79425cc3871f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b68f0836-f232-48ea-bb76-79425cc3871f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="38"
data-executionInfo="{&quot;elapsed&quot;:1311,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944089637,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="01uxojahojuy">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.sample(<span class="dv">700000</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:757,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944090390,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="A6sZtdq_fpKo" data-outputId="82b76cb0-a09c-4cef-ad2d-9ded0e25936d">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;user_id&#39;</span>] <span class="op">=</span> df1.user_id.astype(<span class="bu">object</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;movie_id&#39;</span>] <span class="op">=</span> df1.movie_id.astype(<span class="bu">object</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 700000 entries, 450840 to 829031
Data columns (total 13 columns):
 #   Column        Non-Null Count   Dtype         
---  ------        --------------   -----         
 0   user_id       700000 non-null  object        
 1   movie_id      700000 non-null  object        
 2   rating        700000 non-null  int64         
 3   timestamp     700000 non-null  int64         
 4   date          700000 non-null  datetime64[ns]
 5   hours         700000 non-null  int64         
 6   gender        700000 non-null  object        
 7   age           700000 non-null  int64         
 8   occupation    700000 non-null  int64         
 9   zip_code      700000 non-null  object        
 10  title         700000 non-null  object        
 11  genres        700000 non-null  object        
 12  release_year  700000 non-null  int64         
dtypes: datetime64[ns](1), int64(6), object(6)
memory usage: 74.8+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="40"
data-executionInfo="{&quot;elapsed&quot;:21887,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944112271,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="ak9qgEDnjs-A">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> df1.groupby([<span class="st">&#39;user_id&#39;</span>,<span class="st">&#39;title&#39;</span>])[<span class="st">&#39;movie_id&#39;</span>].<span class="bu">sum</span>().unstack().reset_index().fillna(<span class="dv">0</span>).set_index(<span class="st">&#39;user_id&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:63,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944112273,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="38MROb9Cjt-6" data-outputId="be985230-6420-4067-8f2a-cc27dc0d89d7">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data[data.index <span class="op">==</span> <span class="dv">6036</span>].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">
<pre><code>user_id
6036    1186000
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="42"
data-executionInfo="{&quot;elapsed&quot;:49,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944112275,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="rdzuGo01juBV">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> (data<span class="op">&gt;</span><span class="dv">0</span>).astype(<span class="bu">int</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:49,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944112276,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="dK23p5IMjuD4" data-outputId="4c12dfa1-206b-4ef4-f33b-006def6c8aa1">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>data[data.index <span class="op">==</span> <span class="dv">6036</span>].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<pre><code>user_id
6036    635
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:383}"
data-executionInfo="{&quot;elapsed&quot;:34,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944112277,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Uu8lekcrjuGU" data-outputId="0a292167-4fe5-4292-872f-fb5459ed5a50">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">

  <div id="df-d0db6724-2dd2-45fc-87a4-3c7561a772b0">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>title</th>
      <th>'Night Mother</th>
      <th>'Til There Was You</th>
      <th>'burbs, The</th>
      <th>...And Justice for All</th>
      <th>: A Space Odyssey</th>
      <th>A Chef in Love</th>
      <th>Abbott and Costello Meet Frankenstein</th>
      <th>Abominable Snowman, The</th>
      <th>About Adam</th>
      <th>About Last Night...</th>
      <th>...</th>
      <th>Young Poisoner's Handbook, The</th>
      <th>Young Sherlock Holmes</th>
      <th>Young and Innocent</th>
      <th>Your Friends and Neighbors</th>
      <th>Zachariah</th>
      <th>Zed &amp; Two Noughts, A</th>
      <th>Zero Effect</th>
      <th>Zero Kelvin (Kjrlighetens kjtere)</th>
      <th>Zeus and Roxanne</th>
      <th>eXistenZ</th>
    </tr>
    <tr>
      <th>user_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows  3466 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d0db6724-2dd2-45fc-87a4-3c7561a772b0')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d0db6724-2dd2-45fc-87a4-3c7561a772b0 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d0db6724-2dd2-45fc-87a4-3c7561a772b0');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="45"
data-executionInfo="{&quot;elapsed&quot;:24,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944112279,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="dWjXwZfYkM7u">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.frequent_patterns <span class="im">import</span> apriori</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="46"
data-executionInfo="{&quot;elapsed&quot;:2515,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114772,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="MuxKao06kM-H">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>itemset <span class="op">=</span> apriori(data,min_support<span class="op">=</span><span class="fl">.12</span>,use_colnames<span class="op">=</span><span class="va">True</span>).sort_values(<span class="st">&#39;support&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>).reset_index()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:118,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114778,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="PluUQJcBkNFI" data-outputId="3f31de04-3c6e-4cbe-a413-1dd00227de12">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>itemset.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<pre><code>(578, 3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:107,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114780,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="QLx392TykNIA" data-outputId="806fd8d6-6a43-426d-e06b-71056bb8b8da">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>itemset.loc[itemset[<span class="st">&#39;itemsets&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x)) <span class="op">&gt;=</span> <span class="dv">2</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="48">

  <div id="df-dbb05d99-bafb-4d9c-a9f4-7c3038af920c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>support</th>
      <th>itemsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>558</td>
      <td>0.22</td>
      <td>(Star Wars: Episode V - The Empire Strikes Bac...</td>
    </tr>
    <tr>
      <th>56</th>
      <td>565</td>
      <td>0.20</td>
      <td>(Star Wars: Episode V - The Empire Strikes Bac...</td>
    </tr>
    <tr>
      <th>62</th>
      <td>559</td>
      <td>0.20</td>
      <td>(Star Wars: Episode IV - A New Hope , Star War...</td>
    </tr>
    <tr>
      <th>65</th>
      <td>513</td>
      <td>0.19</td>
      <td>(Star Wars: Episode V - The Empire Strikes Bac...</td>
    </tr>
    <tr>
      <th>75</th>
      <td>430</td>
      <td>0.18</td>
      <td>(Men in Black , Jurassic Park )</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>573</th>
      <td>507</td>
      <td>0.12</td>
      <td>(Shakespeare in Love , Raiders of the Lost Ark )</td>
    </tr>
    <tr>
      <th>574</th>
      <td>449</td>
      <td>0.12</td>
      <td>(L.A. Confidential , Shakespeare in Love )</td>
    </tr>
    <tr>
      <th>575</th>
      <td>528</td>
      <td>0.12</td>
      <td>(Saving Private Ryan , Toy Story )</td>
    </tr>
    <tr>
      <th>576</th>
      <td>467</td>
      <td>0.12</td>
      <td>(Matrix, The , Speed )</td>
    </tr>
    <tr>
      <th>577</th>
      <td>491</td>
      <td>0.12</td>
      <td>(Star Wars: Episode I - The Phantom Menace , P...</td>
    </tr>
  </tbody>
</table>
<p>361 rows  3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-dbb05d99-bafb-4d9c-a9f4-7c3038af920c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-dbb05d99-bafb-4d9c-a9f4-7c3038af920c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-dbb05d99-bafb-4d9c-a9f4-7c3038af920c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="49"
data-executionInfo="{&quot;elapsed&quot;:106,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114782,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="3EacYJTSkNK6">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.frequent_patterns <span class="im">import</span> association_rules </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>rules <span class="op">=</span> association_rules(itemset,metric<span class="op">=</span><span class="st">&#39;lift&#39;</span>,min_threshold<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
data-executionInfo="{&quot;elapsed&quot;:103,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114783,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="XbYAdpBmTJO0" data-outputId="588266c2-ebcb-4e09-c427-651154a4961e">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>rules</span></code></pre></div>
<div class="output execute_result" data-execution_count="50">

  <div id="df-168e9146-11f5-4f18-b083-a11c1575a17a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>antecedent support</th>
      <th>consequent support</th>
      <th>support</th>
      <th>confidence</th>
      <th>lift</th>
      <th>leverage</th>
      <th>conviction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(Star Wars: Episode V - The Empire Strikes Back )</td>
      <td>(Star Wars: Episode IV - A New Hope )</td>
      <td>0.37</td>
      <td>0.38</td>
      <td>0.22</td>
      <td>0.59</td>
      <td>1.58</td>
      <td>0.08</td>
      <td>1.53</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(Star Wars: Episode IV - A New Hope )</td>
      <td>(Star Wars: Episode V - The Empire Strikes Back )</td>
      <td>0.38</td>
      <td>0.37</td>
      <td>0.22</td>
      <td>0.58</td>
      <td>1.58</td>
      <td>0.08</td>
      <td>1.51</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(Star Wars: Episode V - The Empire Strikes Back )</td>
      <td>(Star Wars: Episode VI - Return of the Jedi )</td>
      <td>0.37</td>
      <td>0.36</td>
      <td>0.20</td>
      <td>0.55</td>
      <td>1.52</td>
      <td>0.07</td>
      <td>1.42</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(Star Wars: Episode VI - Return of the Jedi )</td>
      <td>(Star Wars: Episode V - The Empire Strikes Back )</td>
      <td>0.36</td>
      <td>0.37</td>
      <td>0.20</td>
      <td>0.56</td>
      <td>1.52</td>
      <td>0.07</td>
      <td>1.44</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(Star Wars: Episode IV - A New Hope )</td>
      <td>(Star Wars: Episode VI - Return of the Jedi )</td>
      <td>0.38</td>
      <td>0.36</td>
      <td>0.20</td>
      <td>0.52</td>
      <td>1.44</td>
      <td>0.06</td>
      <td>1.33</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>725</th>
      <td>(Toy Story )</td>
      <td>(Saving Private Ryan )</td>
      <td>0.26</td>
      <td>0.33</td>
      <td>0.12</td>
      <td>0.47</td>
      <td>1.40</td>
      <td>0.03</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>726</th>
      <td>(Matrix, The )</td>
      <td>(Speed )</td>
      <td>0.32</td>
      <td>0.21</td>
      <td>0.12</td>
      <td>0.37</td>
      <td>1.81</td>
      <td>0.05</td>
      <td>1.27</td>
    </tr>
    <tr>
      <th>727</th>
      <td>(Speed )</td>
      <td>(Matrix, The )</td>
      <td>0.21</td>
      <td>0.32</td>
      <td>0.12</td>
      <td>0.58</td>
      <td>1.81</td>
      <td>0.05</td>
      <td>1.63</td>
    </tr>
    <tr>
      <th>728</th>
      <td>(Star Wars: Episode I - The Phantom Menace )</td>
      <td>(Princess Bride, The )</td>
      <td>0.28</td>
      <td>0.29</td>
      <td>0.12</td>
      <td>0.43</td>
      <td>1.46</td>
      <td>0.04</td>
      <td>1.24</td>
    </tr>
    <tr>
      <th>729</th>
      <td>(Princess Bride, The )</td>
      <td>(Star Wars: Episode I - The Phantom Menace )</td>
      <td>0.29</td>
      <td>0.28</td>
      <td>0.12</td>
      <td>0.41</td>
      <td>1.46</td>
      <td>0.04</td>
      <td>1.22</td>
    </tr>
  </tbody>
</table>
<p>730 rows  9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-168e9146-11f5-4f18-b083-a11c1575a17a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-168e9146-11f5-4f18-b083-a11c1575a17a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-168e9146-11f5-4f18-b083-a11c1575a17a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="51"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:100,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114784,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="HBWL7kugkNOz" data-outputId="1e7fb61d-1f01-49f8-8763-a748b4e9c79e">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>rules.antecedents.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="51">
<pre><code>(Star Wars: Episode V - The Empire Strikes Back )                                                 44
(Star Wars: Episode IV - A New Hope )                                                             42
(Star Wars: Episode VI - Return of the Jedi )                                                     37
(American Beauty )                                                                                36
(Raiders of the Lost Ark )                                                                        32
(Matrix, The )                                                                                    32
(Silence of the Lambs, The )                                                                      28
(Back to the Future )                                                                             27
(Saving Private Ryan )                                                                            27
(Fargo )                                                                                          25
(Men in Black )                                                                                   24
(Jurassic Park )                                                                                  24
(Braveheart )                                                                                     21
(Princess Bride, The )                                                                            19
(Groundhog Day )                                                                                  19
(Terminator, The )                                                                                19
(Sixth Sense, The )                                                                               19
(Pulp Fiction )                                                                                   18
(Shawshank Redemption, The )                                                                      17
(L.A. Confidential )                                                                              16
(E.T. the Extra-Terrestrial )                                                                     15
(Shakespeare in Love )                                                                            15
(Total Recall )                                                                                   14
(Star Wars: Episode I - The Phantom Menace )                                                      14
(Fugitive, The )                                                                                  13
(Forrest Gump )                                                                                   12
(Alien )                                                                                          11
(Schindler&#39;s List )                                                                               11
(Ghostbusters )                                                                                    9
(Godfather, The )                                                                                  9
(Toy Story )                                                                                       9
(Aliens )                                                                                          8
(Being John Malkovich )                                                                            8
(Blade Runner )                                                                                    7
(Die Hard )                                                                                        6
(GoodFellas )                                                                                      5
(Usual Suspects, The )                                                                             5
(Indiana Jones and the Last Crusade )                                                              4
(Who Framed Roger Rabbit? )                                                                        3
(Abyss, The )                                                                                      3
(Jaws )                                                                                            2
(Star Wars: Episode V - The Empire Strikes Back , Star Wars: Episode IV - A New Hope )             2
(Stand by Me )                                                                                     2
(Wizard of Oz, The )                                                                               2
(Hunt for Red October, The )                                                                       2
(: A Space Odyssey )                                                                               2
(Election )                                                                                        1
(Lethal Weapon )                                                                                   1
(Mission: Impossible )                                                                             1
(Babe )                                                                                            1
(Star Wars: Episode IV - A New Hope , Star Wars: Episode VI - Return of the Jedi )                 1
(Star Wars: Episode IV - A New Hope , Raiders of the Lost Ark )                                    1
(Star Wars: Episode V - The Empire Strikes Back , Raiders of the Lost Ark )                        1
(Star Wars: Episode V - The Empire Strikes Back , Star Wars: Episode VI - Return of the Jedi )     1
(Godfather: Part II, The )                                                                         1
(Gladiator )                                                                                       1
(Speed )                                                                                           1
Name: antecedents, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="52"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:940}"
data-executionInfo="{&quot;elapsed&quot;:80,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944114785,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="qA7Ooc5gkNQ_" data-outputId="421118a4-c8f2-4ac3-870e-fa928cbc1dda">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>rules.loc[rules.antecedents <span class="op">==</span> rules.antecedents.iloc[<span class="dv">15</span>]].sort_values(by<span class="op">=</span><span class="st">&#39;lift&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="52">

  <div id="df-f086cb0f-65d3-43fa-9e2a-8f0860a1380c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>antecedent support</th>
      <th>consequent support</th>
      <th>support</th>
      <th>confidence</th>
      <th>lift</th>
      <th>leverage</th>
      <th>conviction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>627</th>
      <td>(Back to the Future )</td>
      <td>(Aliens )</td>
      <td>0.32</td>
      <td>0.23</td>
      <td>0.12</td>
      <td>0.38</td>
      <td>1.67</td>
      <td>0.05</td>
      <td>1.24</td>
    </tr>
    <tr>
      <th>589</th>
      <td>(Back to the Future )</td>
      <td>(Blade Runner )</td>
      <td>0.32</td>
      <td>0.23</td>
      <td>0.12</td>
      <td>0.38</td>
      <td>1.64</td>
      <td>0.05</td>
      <td>1.24</td>
    </tr>
    <tr>
      <th>249</th>
      <td>(Back to the Future )</td>
      <td>(Terminator, The )</td>
      <td>0.32</td>
      <td>0.27</td>
      <td>0.14</td>
      <td>0.43</td>
      <td>1.63</td>
      <td>0.05</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>177</th>
      <td>(Back to the Future )</td>
      <td>(E.T. the Extra-Terrestrial )</td>
      <td>0.32</td>
      <td>0.28</td>
      <td>0.15</td>
      <td>0.46</td>
      <td>1.62</td>
      <td>0.06</td>
      <td>1.32</td>
    </tr>
    <tr>
      <th>241</th>
      <td>(Back to the Future )</td>
      <td>(Ghostbusters )</td>
      <td>0.32</td>
      <td>0.27</td>
      <td>0.14</td>
      <td>0.43</td>
      <td>1.62</td>
      <td>0.05</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>492</th>
      <td>(Back to the Future )</td>
      <td>(Alien )</td>
      <td>0.32</td>
      <td>0.25</td>
      <td>0.13</td>
      <td>0.39</td>
      <td>1.56</td>
      <td>0.05</td>
      <td>1.23</td>
    </tr>
    <tr>
      <th>193</th>
      <td>(Back to the Future )</td>
      <td>(Princess Bride, The )</td>
      <td>0.32</td>
      <td>0.29</td>
      <td>0.15</td>
      <td>0.45</td>
      <td>1.54</td>
      <td>0.05</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>15</th>
      <td>(Back to the Future )</td>
      <td>(Star Wars: Episode V - The Empire Strikes Back )</td>
      <td>0.32</td>
      <td>0.37</td>
      <td>0.18</td>
      <td>0.55</td>
      <td>1.50</td>
      <td>0.06</td>
      <td>1.41</td>
    </tr>
    <tr>
      <th>656</th>
      <td>(Back to the Future )</td>
      <td>(Total Recall )</td>
      <td>0.32</td>
      <td>0.25</td>
      <td>0.12</td>
      <td>0.38</td>
      <td>1.48</td>
      <td>0.04</td>
      <td>1.20</td>
    </tr>
    <tr>
      <th>595</th>
      <td>(Back to the Future )</td>
      <td>(Toy Story )</td>
      <td>0.32</td>
      <td>0.26</td>
      <td>0.12</td>
      <td>0.38</td>
      <td>1.48</td>
      <td>0.04</td>
      <td>1.20</td>
    </tr>
    <tr>
      <th>147</th>
      <td>(Back to the Future )</td>
      <td>(Raiders of the Lost Ark )</td>
      <td>0.32</td>
      <td>0.32</td>
      <td>0.15</td>
      <td>0.47</td>
      <td>1.47</td>
      <td>0.05</td>
      <td>1.28</td>
    </tr>
    <tr>
      <th>155</th>
      <td>(Back to the Future )</td>
      <td>(Men in Black )</td>
      <td>0.32</td>
      <td>0.32</td>
      <td>0.15</td>
      <td>0.46</td>
      <td>1.46</td>
      <td>0.05</td>
      <td>1.27</td>
    </tr>
    <tr>
      <th>39</th>
      <td>(Back to the Future )</td>
      <td>(Star Wars: Episode VI - Return of the Jedi )</td>
      <td>0.32</td>
      <td>0.36</td>
      <td>0.17</td>
      <td>0.53</td>
      <td>1.46</td>
      <td>0.05</td>
      <td>1.35</td>
    </tr>
    <tr>
      <th>363</th>
      <td>(Back to the Future )</td>
      <td>(Groundhog Day )</td>
      <td>0.32</td>
      <td>0.29</td>
      <td>0.13</td>
      <td>0.41</td>
      <td>1.45</td>
      <td>0.04</td>
      <td>1.22</td>
    </tr>
    <tr>
      <th>27</th>
      <td>(Back to the Future )</td>
      <td>(Star Wars: Episode IV - A New Hope )</td>
      <td>0.32</td>
      <td>0.38</td>
      <td>0.18</td>
      <td>0.54</td>
      <td>1.44</td>
      <td>0.05</td>
      <td>1.36</td>
    </tr>
    <tr>
      <th>529</th>
      <td>(Back to the Future )</td>
      <td>(Forrest Gump )</td>
      <td>0.32</td>
      <td>0.27</td>
      <td>0.13</td>
      <td>0.39</td>
      <td>1.42</td>
      <td>0.04</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>489</th>
      <td>(Back to the Future )</td>
      <td>(Star Wars: Episode I - The Phantom Menace )</td>
      <td>0.32</td>
      <td>0.28</td>
      <td>0.13</td>
      <td>0.39</td>
      <td>1.41</td>
      <td>0.04</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>195</th>
      <td>(Back to the Future )</td>
      <td>(Matrix, The )</td>
      <td>0.32</td>
      <td>0.32</td>
      <td>0.15</td>
      <td>0.45</td>
      <td>1.40</td>
      <td>0.04</td>
      <td>1.24</td>
    </tr>
    <tr>
      <th>182</th>
      <td>(Back to the Future )</td>
      <td>(Jurassic Park )</td>
      <td>0.32</td>
      <td>0.34</td>
      <td>0.15</td>
      <td>0.46</td>
      <td>1.36</td>
      <td>0.04</td>
      <td>1.22</td>
    </tr>
    <tr>
      <th>692</th>
      <td>(Back to the Future )</td>
      <td>(Shawshank Redemption, The )</td>
      <td>0.32</td>
      <td>0.29</td>
      <td>0.12</td>
      <td>0.37</td>
      <td>1.31</td>
      <td>0.03</td>
      <td>1.14</td>
    </tr>
    <tr>
      <th>279</th>
      <td>(Back to the Future )</td>
      <td>(Silence of the Lambs, The )</td>
      <td>0.32</td>
      <td>0.33</td>
      <td>0.14</td>
      <td>0.43</td>
      <td>1.30</td>
      <td>0.03</td>
      <td>1.17</td>
    </tr>
    <tr>
      <th>615</th>
      <td>(Back to the Future )</td>
      <td>(Shakespeare in Love )</td>
      <td>0.32</td>
      <td>0.30</td>
      <td>0.12</td>
      <td>0.38</td>
      <td>1.28</td>
      <td>0.03</td>
      <td>1.13</td>
    </tr>
    <tr>
      <th>451</th>
      <td>(Back to the Future )</td>
      <td>(Fargo )</td>
      <td>0.32</td>
      <td>0.32</td>
      <td>0.13</td>
      <td>0.40</td>
      <td>1.26</td>
      <td>0.03</td>
      <td>1.14</td>
    </tr>
    <tr>
      <th>355</th>
      <td>(Back to the Future )</td>
      <td>(Saving Private Ryan )</td>
      <td>0.32</td>
      <td>0.33</td>
      <td>0.13</td>
      <td>0.42</td>
      <td>1.25</td>
      <td>0.03</td>
      <td>1.14</td>
    </tr>
    <tr>
      <th>637</th>
      <td>(Back to the Future )</td>
      <td>(Sixth Sense, The )</td>
      <td>0.32</td>
      <td>0.30</td>
      <td>0.12</td>
      <td>0.38</td>
      <td>1.25</td>
      <td>0.02</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>557</th>
      <td>(Back to the Future )</td>
      <td>(Braveheart )</td>
      <td>0.32</td>
      <td>0.31</td>
      <td>0.12</td>
      <td>0.39</td>
      <td>1.23</td>
      <td>0.02</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>129</th>
      <td>(Back to the Future )</td>
      <td>(American Beauty )</td>
      <td>0.32</td>
      <td>0.43</td>
      <td>0.15</td>
      <td>0.47</td>
      <td>1.09</td>
      <td>0.01</td>
      <td>1.07</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f086cb0f-65d3-43fa-9e2a-8f0860a1380c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f086cb0f-65d3-43fa-9e2a-8f0860a1380c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f086cb0f-65d3-43fa-9e2a-8f0860a1380c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="recommendations-according-to-movie-genres"
class="cell markdown" id="1-5AyuNP6PcD">
<h3><strong><em>Recommendations according to movie
genres</em></strong></h3>
</section>
<div class="cell code" data-execution_count="53"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:468}"
data-executionInfo="{&quot;elapsed&quot;:3571,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944118279,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="AgTbKdkvmUDE" data-outputId="395c3d40-8184-4d8b-8f93-5014f5992de7">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploding feature genres</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.copy()</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;genres&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;genres&#39;</span>].<span class="bu">str</span>.split(<span class="st">&#39;|&#39;</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.explode(<span class="st">&#39;genres&#39;</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<div class="output execute_result" data-execution_count="53">

  <div id="df-fab4b0a8-3806-49fd-9a39-7e74d87ba0d6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>2000-12-31</td>
      <td>21</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>2000-12-30</td>
      <td>23</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>2000-12-30</td>
      <td>18</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>1193</td>
      <td>4</td>
      <td>978156168</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>F</td>
      <td>18</td>
      <td>3</td>
      <td>95825</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000206</th>
      <td>5780</td>
      <td>2845</td>
      <td>1</td>
      <td>958153068</td>
      <td>2000-12-05</td>
      <td>17</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>92886</td>
      <td>White Boys</td>
      <td>Drama</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Comedy</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Drama</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Western</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000208</th>
      <td>5938</td>
      <td>2909</td>
      <td>4</td>
      <td>957273353</td>
      <td>2000-02-05</td>
      <td>13</td>
      <td>M</td>
      <td>25</td>
      <td>1</td>
      <td>35401</td>
      <td>Five Wives, Three Secretaries and Me</td>
      <td>Documentary</td>
      <td>1998</td>
    </tr>
  </tbody>
</table>
<p>1958837 rows  13 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fab4b0a8-3806-49fd-9a39-7e74d87ba0d6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fab4b0a8-3806-49fd-9a39-7e74d87ba0d6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fab4b0a8-3806-49fd-9a39-7e74d87ba0d6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="54"
data-executionInfo="{&quot;elapsed&quot;:73,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944118283,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="swWvHRDrlW1h">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df2.copy().sample(<span class="dv">1000000</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:468}"
data-executionInfo="{&quot;elapsed&quot;:72,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944118284,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="pfX-sYL2UFID" data-outputId="2ccf4d02-2abf-4734-b46b-a29a0966db0d">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<div class="output execute_result" data-execution_count="55">

  <div id="df-dcf0319a-25fb-4ce8-b5dc-1172c84f7b0e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>2000-12-31</td>
      <td>21</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>2000-12-30</td>
      <td>23</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>2000-12-30</td>
      <td>18</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>1193</td>
      <td>4</td>
      <td>978156168</td>
      <td>2000-12-30</td>
      <td>6</td>
      <td>F</td>
      <td>18</td>
      <td>3</td>
      <td>95825</td>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>Drama</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000206</th>
      <td>5780</td>
      <td>2845</td>
      <td>1</td>
      <td>958153068</td>
      <td>2000-12-05</td>
      <td>17</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>92886</td>
      <td>White Boys</td>
      <td>Drama</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Comedy</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Drama</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>2000-08-05</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>One Little Indian</td>
      <td>Western</td>
      <td>1973</td>
    </tr>
    <tr>
      <th>1000208</th>
      <td>5938</td>
      <td>2909</td>
      <td>4</td>
      <td>957273353</td>
      <td>2000-02-05</td>
      <td>13</td>
      <td>M</td>
      <td>25</td>
      <td>1</td>
      <td>35401</td>
      <td>Five Wives, Three Secretaries and Me</td>
      <td>Documentary</td>
      <td>1998</td>
    </tr>
  </tbody>
</table>
<p>1958837 rows  13 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-dcf0319a-25fb-4ce8-b5dc-1172c84f7b0e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-dcf0319a-25fb-4ce8-b5dc-1172c84f7b0e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-dcf0319a-25fb-4ce8-b5dc-1172c84f7b0e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="56"
data-executionInfo="{&quot;elapsed&quot;:1168,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944119431,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="ni9P13_msDOz">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.sample(<span class="dv">700000</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="57"
data-executionInfo="{&quot;elapsed&quot;:20,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944119432,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="1kyeQzFfspvA">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from tensorflow.keras import backend as K</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># K.clear_session()</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="58"
data-executionInfo="{&quot;elapsed&quot;:19,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944119433,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="abL8VnT9pHqc">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> df2.groupby([<span class="st">&#39;user_id&#39;</span>,<span class="st">&#39;genres&#39;</span>])[<span class="st">&#39;movie_id&#39;</span>].<span class="bu">sum</span>().unstack().reset_index().fillna(<span class="dv">0</span>).set_index(<span class="st">&#39;user_id&#39;</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> (data<span class="op">&gt;</span><span class="dv">0</span>).astype(<span class="bu">int</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:319}"
data-executionInfo="{&quot;elapsed&quot;:20,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944119435,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="zwqA-ycspHs5" data-outputId="29fc9a14-bdd5-4eac-bafb-9650f66a5382">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="59">

  <div id="df-bc1c7529-0a85-4e20-a588-4f7573f76a2a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>genres</th>
      <th>Action</th>
      <th>Adventure</th>
      <th>Animation</th>
      <th>Children's</th>
      <th>Comedy</th>
      <th>Crime</th>
      <th>Documentary</th>
      <th>Drama</th>
      <th>Fantasy</th>
      <th>Film-Noir</th>
      <th>Horror</th>
      <th>Musical</th>
      <th>Mystery</th>
      <th>Romance</th>
      <th>Sci-Fi</th>
      <th>Thriller</th>
      <th>War</th>
      <th>Western</th>
    </tr>
    <tr>
      <th>user_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bc1c7529-0a85-4e20-a588-4f7573f76a2a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bc1c7529-0a85-4e20-a588-4f7573f76a2a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bc1c7529-0a85-4e20-a588-4f7573f76a2a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="60"
data-executionInfo="{&quot;elapsed&quot;:899,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944120320,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="_MGoTw3spHye">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.frequent_patterns <span class="im">import</span> apriori</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>itemset <span class="op">=</span> apriori(data,min_support<span class="op">=</span><span class="fl">.5</span>,use_colnames<span class="op">=</span><span class="va">True</span>).sort_values(<span class="st">&#39;support&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>).reset_index()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="61"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:67,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944120321,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="6H4MsnfKqMJ0" data-outputId="5a9112d5-1479-4029-9f2d-f3ec801ceb31">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>itemset.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>(2253, 3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="62"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:15,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944120322,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="jaSLjphJqLvs" data-outputId="2e2dcd5c-646a-4c25-8cdc-c968a3ea8c5b">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>itemset.loc[itemset[<span class="st">&#39;itemsets&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x)) <span class="op">&gt;=</span> <span class="dv">2</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="62">

  <div id="df-af42d590-0da3-45b8-b648-8f492968bd73">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>support</th>
      <th>itemsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>59</td>
      <td>0.97</td>
      <td>(Comedy, Drama)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.94</td>
      <td>(Drama, Action)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.93</td>
      <td>(Comedy, Action)</td>
    </tr>
    <tr>
      <th>7</th>
      <td>137</td>
      <td>0.92</td>
      <td>(Comedy, Drama, Action)</td>
    </tr>
    <tr>
      <th>8</th>
      <td>83</td>
      <td>0.92</td>
      <td>(Thriller, Drama)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2248</th>
      <td>1539</td>
      <td>0.50</td>
      <td>(Horror, Sci-Fi, Crime, War, Romance)</td>
    </tr>
    <tr>
      <th>2249</th>
      <td>1999</td>
      <td>0.50</td>
      <td>(Horror, Sci-Fi, Drama, Crime, War, Romance)</td>
    </tr>
    <tr>
      <th>2250</th>
      <td>1985</td>
      <td>0.50</td>
      <td>(Comedy, Sci-Fi, Drama, War, Thriller, Fantasy)</td>
    </tr>
    <tr>
      <th>2251</th>
      <td>1383</td>
      <td>0.50</td>
      <td>(Sci-Fi, Drama, War, Adventure, Fantasy)</td>
    </tr>
    <tr>
      <th>2252</th>
      <td>1478</td>
      <td>0.50</td>
      <td>(Comedy, Crime, War, Mystery, Romance)</td>
    </tr>
  </tbody>
</table>
<p>2238 rows  3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-af42d590-0da3-45b8-b648-8f492968bd73')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-af42d590-0da3-45b8-b648-8f492968bd73 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-af42d590-0da3-45b8-b648-8f492968bd73');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="63"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:991,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944121302,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Zi2u3kkwpH18" data-outputId="8daa47a6-1028-4030-84ca-d580c5c84765">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.frequent_patterns <span class="im">import</span> association_rules </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>rules <span class="op">=</span> association_rules(itemset,metric<span class="op">=</span><span class="st">&#39;lift&#39;</span>,min_threshold<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>rules.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="63">

  <div id="df-e5d0b034-3d02-43d1-a24a-cfc425f3279b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>antecedent support</th>
      <th>consequent support</th>
      <th>support</th>
      <th>confidence</th>
      <th>lift</th>
      <th>leverage</th>
      <th>conviction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(Comedy)</td>
      <td>(Drama)</td>
      <td>0.98</td>
      <td>0.99</td>
      <td>0.97</td>
      <td>0.99</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(Drama)</td>
      <td>(Comedy)</td>
      <td>0.99</td>
      <td>0.98</td>
      <td>0.97</td>
      <td>0.98</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(Drama)</td>
      <td>(Action)</td>
      <td>0.99</td>
      <td>0.95</td>
      <td>0.94</td>
      <td>0.95</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.04</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(Action)</td>
      <td>(Drama)</td>
      <td>0.95</td>
      <td>0.99</td>
      <td>0.94</td>
      <td>0.99</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(Comedy)</td>
      <td>(Action)</td>
      <td>0.98</td>
      <td>0.95</td>
      <td>0.93</td>
      <td>0.95</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.05</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e5d0b034-3d02-43d1-a24a-cfc425f3279b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e5d0b034-3d02-43d1-a24a-cfc425f3279b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e5d0b034-3d02-43d1-a24a-cfc425f3279b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:66,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944121303,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="_ddUdGRapH92" data-outputId="c1f9b758-0798-466c-94c2-5536e47390a6">
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rules.antecedents.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">
<pre><code>(Drama)                                                    1120
(Comedy)                                                   1110
(Action)                                                   1096
(Thriller)                                                 1064
(Romance)                                                  1006
                                                           ... 
(Action, Comedy, Drama, Musical, Adventure, Thriller)         1
(Action, Comedy, Drama, Musical, Romance, Thriller)           1
(Action, Comedy, Drama, Musical, Adventure, Romance)          1
(Action, Comedy, Musical, Adventure, Romance, Thriller)       1
(Sci-Fi, War, Fantasy, Adventure)                             1
Name: antecedents, Length: 2173, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:73,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944121344,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="mi7Vv3bWpIAp" data-outputId="a43dacfb-8f84-433a-c227-9f00c1b4ece7">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>rules.loc[rules.antecedents <span class="op">==</span> rules.antecedents.iloc[<span class="dv">15</span>]].sort_values(by<span class="op">=</span><span class="st">&#39;lift&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="65">

  <div id="df-ef314c32-3c64-47d8-a4c4-1eaada95fcb4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>antecedent support</th>
      <th>consequent support</th>
      <th>support</th>
      <th>confidence</th>
      <th>lift</th>
      <th>leverage</th>
      <th>conviction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82419</th>
      <td>(Thriller)</td>
      <td>(Horror, Action, Comedy, Sci-Fi, Drama, Crime,...</td>
      <td>0.93</td>
      <td>0.51</td>
      <td>0.51</td>
      <td>0.55</td>
      <td>1.07</td>
      <td>0.03</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>75457</th>
      <td>(Thriller)</td>
      <td>(Horror, Action, Sci-Fi, Drama, Crime, War)</td>
      <td>0.93</td>
      <td>0.51</td>
      <td>0.51</td>
      <td>0.55</td>
      <td>1.07</td>
      <td>0.03</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>81919</th>
      <td>(Thriller)</td>
      <td>(Horror, Action, Comedy, Sci-Fi, Crime, War)</td>
      <td>0.93</td>
      <td>0.51</td>
      <td>0.51</td>
      <td>0.55</td>
      <td>1.07</td>
      <td>0.03</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>88373</th>
      <td>(Thriller)</td>
      <td>(Horror, Action, Comedy, Drama, Crime, War, Ad...</td>
      <td>0.93</td>
      <td>0.51</td>
      <td>0.50</td>
      <td>0.54</td>
      <td>1.07</td>
      <td>0.03</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>74621</th>
      <td>(Thriller)</td>
      <td>(Horror, Action, Sci-Fi, Crime, War)</td>
      <td>0.93</td>
      <td>0.51</td>
      <td>0.51</td>
      <td>0.55</td>
      <td>1.07</td>
      <td>0.03</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>151</th>
      <td>(Thriller)</td>
      <td>(Comedy, Romance)</td>
      <td>0.93</td>
      <td>0.89</td>
      <td>0.83</td>
      <td>0.89</td>
      <td>1.01</td>
      <td>0.01</td>
      <td>1.06</td>
    </tr>
    <tr>
      <th>99</th>
      <td>(Thriller)</td>
      <td>(Romance)</td>
      <td>0.93</td>
      <td>0.90</td>
      <td>0.84</td>
      <td>0.91</td>
      <td>1.01</td>
      <td>0.01</td>
      <td>1.07</td>
    </tr>
    <tr>
      <th>20</th>
      <td>(Thriller)</td>
      <td>(Comedy, Drama)</td>
      <td>0.93</td>
      <td>0.97</td>
      <td>0.90</td>
      <td>0.97</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.09</td>
    </tr>
    <tr>
      <th>12</th>
      <td>(Thriller)</td>
      <td>(Drama)</td>
      <td>0.93</td>
      <td>0.99</td>
      <td>0.92</td>
      <td>0.99</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>15</th>
      <td>(Thriller)</td>
      <td>(Comedy)</td>
      <td>0.93</td>
      <td>0.98</td>
      <td>0.91</td>
      <td>0.98</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.05</td>
    </tr>
  </tbody>
</table>
<p>1064 rows  9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ef314c32-3c64-47d8-a4c4-1eaada95fcb4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ef314c32-3c64-47d8-a4c4-1eaada95fcb4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ef314c32-3c64-47d8-a4c4-1eaada95fcb4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="apriori-algorithm-ends" class="cell markdown"
id="3fXEAJamoe6m">
<h3><strong><em>Apriori</em></strong> <strong><em>Algorithm
Ends</em></strong></h3>
</section>
<div class="cell code" data-execution_count="66"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:337}"
data-executionInfo="{&quot;elapsed&quot;:70,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944121345,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="tgyhBPoCpHAJ" data-outputId="8ddaf7a1-6df7-4a55-8494-6a2aae29cea1">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="66">

  <div id="df-30b79087-982e-41d5-ad51-79b4c6339917">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>735006</th>
      <td>4683</td>
      <td>2642</td>
      <td>1</td>
      <td>963676881</td>
      <td>2000-07-15</td>
      <td>16</td>
      <td>M</td>
      <td>25</td>
      <td>0</td>
      <td>22101</td>
      <td>Superman III</td>
      <td>Action</td>
      <td>1983</td>
    </tr>
    <tr>
      <th>740271</th>
      <td>5734</td>
      <td>11</td>
      <td>5</td>
      <td>976312039</td>
      <td>2000-08-12</td>
      <td>21</td>
      <td>F</td>
      <td>25</td>
      <td>14</td>
      <td>10022</td>
      <td>American President, The</td>
      <td>Comedy</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>579188</th>
      <td>117</td>
      <td>10</td>
      <td>4</td>
      <td>977501371</td>
      <td>2000-12-22</td>
      <td>16</td>
      <td>M</td>
      <td>25</td>
      <td>17</td>
      <td>33314</td>
      <td>GoldenEye</td>
      <td>Thriller</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>996457</th>
      <td>5795</td>
      <td>888</td>
      <td>2</td>
      <td>958146185</td>
      <td>2000-12-05</td>
      <td>15</td>
      <td>M</td>
      <td>25</td>
      <td>1</td>
      <td>92688</td>
      <td>Land Before Time III: The Time of the Great Gi...</td>
      <td>Children's</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>384904</th>
      <td>3017</td>
      <td>25</td>
      <td>4</td>
      <td>970507008</td>
      <td>2000-02-10</td>
      <td>17</td>
      <td>F</td>
      <td>35</td>
      <td>9</td>
      <td>85255</td>
      <td>Leaving Las Vegas</td>
      <td>Romance</td>
      <td>1995</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-30b79087-982e-41d5-ad51-79b4c6339917')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-30b79087-982e-41d5-ad51-79b4c6339917 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-30b79087-982e-41d5-ad51-79b4c6339917');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="1-Nd9bZLLham">
<hr />
<h2
id="-several-similaity-mesuring-functions-and-similarity-based-recommender-system-function">####
<strong><em>Several similaity mesuring functions and similarity based
recommender system function</em></strong></h2>
</div>
<div class="cell code" data-execution_count="67"
data-executionInfo="{&quot;elapsed&quot;:68,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944121346,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="MW6HAUWFcMdl">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(x,y):</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">abs</span>(x<span class="op">-</span>y))</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidian_distance(x,y):</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> np.sqrt(np.<span class="bu">sum</span>((x<span class="op">-</span>y)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cosine_similarity(v1, v2):</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    dot_prod <span class="op">=</span> np.dot(v1, v2)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    norm_v1 <span class="op">=</span> np.linalg.norm(v1)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    norm_v2 <span class="op">=</span> np.linalg.norm(v2)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dot_prod <span class="op">/</span> (norm_v1 <span class="op">*</span> norm_v2)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pearson_sim(x,y):</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the mean of x and y</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    x_mean <span class="op">=</span> np.mean(x)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    y_mean <span class="op">=</span> np.mean(y)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the numerator</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> np.<span class="bu">sum</span>((x <span class="op">-</span> x_mean) <span class="op">*</span> (y <span class="op">-</span> y_mean))</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the denominator</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>    x_denom <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>((x <span class="op">-</span> x_mean)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    y_denom <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>((y <span class="op">-</span> y_mean)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    denom <span class="op">=</span> x_denom <span class="op">*</span> y_denom</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the Pearson correlation coefficient</span></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> num <span class="op">/</span> denom</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> similarity_based_recsys(m,movies,movie_id,hamming_distance):</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>  ranks <span class="op">=</span> []</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> query <span class="kw">in</span> m.index[:<span class="dv">10</span>]:</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> candidate <span class="kw">in</span> m.index:</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> candidate <span class="op">==</span> query:</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>              <span class="cf">continue</span></span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>          ranks.append([query, candidate, hamming_distance(m.loc[query], m.loc[candidate])])</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>  ranks <span class="op">=</span> pd.DataFrame(ranks, columns<span class="op">=</span>[<span class="st">&#39;query&#39;</span>, <span class="st">&#39;candidate&#39;</span>, <span class="st">&#39;distance&#39;</span>])</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>  ranks <span class="op">=</span> ranks.merge(movies[[<span class="st">&#39;movie_id&#39;</span>, <span class="st">&#39;title&#39;</span>]], left_on<span class="op">=</span><span class="st">&#39;query&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;movie_id&#39;</span>).rename(columns<span class="op">=</span>{<span class="st">&#39;title&#39;</span>: <span class="st">&#39;query_tittle&#39;</span>}).drop(columns<span class="op">=</span>[<span class="st">&#39;movie_id&#39;</span>])</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>  ranks <span class="op">=</span> ranks.merge(movies[[<span class="st">&#39;movie_id&#39;</span>, <span class="st">&#39;title&#39;</span>]], left_on<span class="op">=</span><span class="st">&#39;candidate&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;movie_id&#39;</span>).rename(columns<span class="op">=</span>{<span class="st">&#39;title&#39;</span>: <span class="st">&#39;recommendation_title&#39;</span>}).drop(columns<span class="op">=</span>[<span class="st">&#39;movie_id&#39;</span>])</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>  ranks <span class="op">=</span> ranks.sort_values(by<span class="op">=</span>[<span class="st">&#39;query&#39;</span>, <span class="st">&#39;distance&#39;</span>])</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ranks</span></code></pre></div>
</div>
<div class="cell markdown" id="ACFNIHZ7LZOt">
<hr />
<h2 id="-pivot-table-for-item-item-based-recommender-system">####
<strong><em>Pivot table for item item based recommender
system</em></strong></h2>
</div>
<div class="cell code" data-execution_count="68"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:319}"
data-executionInfo="{&quot;elapsed&quot;:1116,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944122395,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="bqIxbUnj5EzU" data-outputId="b8551413-2c1a-41ab-af7b-463eb5021d8a">
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> df2.groupby([<span class="st">&#39;movie_id&#39;</span>,<span class="st">&#39;genres&#39;</span>])[<span class="st">&#39;title&#39;</span>].unique().<span class="bu">str</span>[<span class="dv">0</span>].unstack().reset_index().set_index(<span class="st">&#39;movie_id&#39;</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="op">~</span>m.isna()</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> m.astype(<span class="bu">int</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>m.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="68">

  <div id="df-6233fb8c-ada8-4ef2-8a8e-8357419656c4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>genres</th>
      <th>Action</th>
      <th>Adventure</th>
      <th>Animation</th>
      <th>Children's</th>
      <th>Comedy</th>
      <th>Crime</th>
      <th>Documentary</th>
      <th>Drama</th>
      <th>Fantasy</th>
      <th>Film-Noir</th>
      <th>Horror</th>
      <th>Musical</th>
      <th>Mystery</th>
      <th>Romance</th>
      <th>Sci-Fi</th>
      <th>Thriller</th>
      <th>War</th>
      <th>Western</th>
    </tr>
    <tr>
      <th>movie_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6233fb8c-ada8-4ef2-8a8e-8357419656c4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6233fb8c-ada8-4ef2-8a8e-8357419656c4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6233fb8c-ada8-4ef2-8a8e-8357419656c4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="CkmFsdwALUXI">
<hr />
<h2
id="-item-item-based-recommender-system-using-cosine-similarity">####
<strong><em>Item item based recommender system using cosine
similarity</em></strong></h2>
</div>
<div class="cell code" data-execution_count="69"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:7408,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944129795,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="NCizWNvUcMfl" data-outputId="3cdf1997-bfc8-40f9-f111-c53252e06d9c">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>similarity_based_recsys(m,movies[[<span class="st">&#39;movie_id&#39;</span>, <span class="st">&#39;title&#39;</span>]],movies.movie_id,cosine_similarity)</span></code></pre></div>
<div class="output execute_result" data-execution_count="69">

  <div id="df-e09e4863-3ca7-43b3-8830-d23e0e4b4690">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>query</th>
      <th>candidate</th>
      <th>distance</th>
      <th>query_tittle</th>
      <th>recommendation_title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>1</td>
      <td>6</td>
      <td>0.00</td>
      <td>Toy Story (1995)</td>
      <td>Heat (1995)</td>
    </tr>
    <tr>
      <th>63</th>
      <td>1</td>
      <td>9</td>
      <td>0.00</td>
      <td>Toy Story (1995)</td>
      <td>Sudden Death (1995)</td>
    </tr>
    <tr>
      <th>72</th>
      <td>1</td>
      <td>10</td>
      <td>0.00</td>
      <td>Toy Story (1995)</td>
      <td>GoldenEye (1995)</td>
    </tr>
    <tr>
      <th>111</th>
      <td>1</td>
      <td>14</td>
      <td>0.00</td>
      <td>Toy Story (1995)</td>
      <td>Nixon (1995)</td>
    </tr>
    <tr>
      <th>121</th>
      <td>1</td>
      <td>15</td>
      <td>0.00</td>
      <td>Toy Story (1995)</td>
      <td>Cutthroat Island (1995)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8540</th>
      <td>10</td>
      <td>990</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Maximum Risk (1996)</td>
    </tr>
    <tr>
      <th>12820</th>
      <td>10</td>
      <td>1499</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Anaconda (1997)</td>
    </tr>
    <tr>
      <th>13250</th>
      <td>10</td>
      <td>1552</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Con Air (1997)</td>
    </tr>
    <tr>
      <th>14750</th>
      <td>10</td>
      <td>1744</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Firestorm (1998)</td>
    </tr>
    <tr>
      <th>32450</th>
      <td>10</td>
      <td>3755</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Perfect Storm, The (2000)</td>
    </tr>
  </tbody>
</table>
<p>34270 rows  5 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e09e4863-3ca7-43b3-8830-d23e0e4b4690')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e09e4863-3ca7-43b3-8830-d23e0e4b4690 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e09e4863-3ca7-43b3-8830-d23e0e4b4690');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="NHH9ZsUJK7dF">
<hr />
<h2
id="-item-item-based-recommender-system-using-pearson-correlation-similarity">####
<strong><em>Item item based recommender system using pearson correlation
similarity</em></strong></h2>
</div>
<div class="cell code" data-execution_count="70"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:424}"
data-executionInfo="{&quot;elapsed&quot;:50649,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944180432,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Pjrcx3AQKWhU" data-outputId="7171e1b3-55d1-47e1-dcb2-a5f3eabbf9ba">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>similarity_based_recsys(m,movies[[<span class="st">&#39;movie_id&#39;</span>, <span class="st">&#39;title&#39;</span>]],movies.movie_id,pearson_sim)</span></code></pre></div>
<div class="output execute_result" data-execution_count="70">

  <div id="df-7c5359c1-a6ac-44eb-95a6-f0fb9def597a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>query</th>
      <th>candidate</th>
      <th>distance</th>
      <th>query_tittle</th>
      <th>recommendation_title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10201</th>
      <td>1</td>
      <td>1196</td>
      <td>-0.28</td>
      <td>Toy Story (1995)</td>
      <td>Star Wars: Episode V - The Empire Strikes Back...</td>
    </tr>
    <tr>
      <th>10331</th>
      <td>1</td>
      <td>1210</td>
      <td>-0.28</td>
      <td>Toy Story (1995)</td>
      <td>Star Wars: Episode VI - Return of the Jedi (1983)</td>
    </tr>
    <tr>
      <th>10841</th>
      <td>1</td>
      <td>1264</td>
      <td>-0.28</td>
      <td>Toy Story (1995)</td>
      <td>Diva (1981)</td>
    </tr>
    <tr>
      <th>19681</th>
      <td>1</td>
      <td>2322</td>
      <td>-0.28</td>
      <td>Toy Story (1995)</td>
      <td>Soldier (1998)</td>
    </tr>
    <tr>
      <th>1451</th>
      <td>1</td>
      <td>160</td>
      <td>-0.24</td>
      <td>Toy Story (1995)</td>
      <td>Congo (1995)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8540</th>
      <td>10</td>
      <td>990</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Maximum Risk (1996)</td>
    </tr>
    <tr>
      <th>12820</th>
      <td>10</td>
      <td>1499</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Anaconda (1997)</td>
    </tr>
    <tr>
      <th>13250</th>
      <td>10</td>
      <td>1552</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Con Air (1997)</td>
    </tr>
    <tr>
      <th>14750</th>
      <td>10</td>
      <td>1744</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Firestorm (1998)</td>
    </tr>
    <tr>
      <th>32450</th>
      <td>10</td>
      <td>3755</td>
      <td>1.00</td>
      <td>GoldenEye (1995)</td>
      <td>Perfect Storm, The (2000)</td>
    </tr>
  </tbody>
</table>
<p>34270 rows  5 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7c5359c1-a6ac-44eb-95a6-f0fb9def597a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7c5359c1-a6ac-44eb-95a6-f0fb9def597a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7c5359c1-a6ac-44eb-95a6-f0fb9def597a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="NWOU7ZQZcyF2">
<hr />
<h2 id="-csr-matrix">#### <strong><em>CSR Matrix</em></strong></h2>
</div>
<div class="cell code" data-execution_count="71"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:100,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944180435,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="oDz5pZhly5VO" data-outputId="10f9aec0-c720-4268-a981-6a9f5e434344">
<div class="sourceCode" id="cb91"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>cmfrec.csr_matrix(np.array(m)).toarray()</span></code></pre></div>
<div class="output execute_result" data-execution_count="71">
<pre><code>array([[0, 0, 1, ..., 0, 0, 0],
       [0, 1, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 1, 0, 0]])</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:44,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944180438,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="boWLC-SBy5aD" data-outputId="8ffb9df3-793e-405b-aa07-141cebdb34e9">
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>cmfrec.csr_matrix(np.array(m))</span></code></pre></div>
<div class="output execute_result" data-execution_count="72">
<pre><code>&lt;3428x18 sparse matrix of type &#39;&lt;class &#39;numpy.int64&#39;&gt;&#39;
	with 5752 stored elements in Compressed Sparse Row format&gt;</code></pre>
</div>
</div>
<div class="cell markdown" id="SgKmM08Mc7sX">
<hr />
<h2 id="-csr-matrix-ends">#### <strong><em>CSR Matrix
Ends</em></strong></h2>
</div>
<div class="cell markdown" id="Gc9o0BzAT6OG">
<hr />
<h2 id="-collaborative-filtering-item-based--user-based-approach">####
<strong><em>Collaborative Filtering (Item-based &amp; User-based
Approach)</em></strong></h2>
</div>
<div class="cell code" data-execution_count="73"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:29,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944180440,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="XJicqlAoNLjG" data-outputId="78b16417-1dff-4ba3-dc7a-5220645e4541">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>ratings.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="73">

  <div id="df-d8953d55-1af9-4a7e-8ba0-20d194657a8e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
      <td>2000-12-31</td>
      <td>22</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
      <td>2001-06-01</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d8953d55-1af9-4a7e-8ba0-20d194657a8e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d8953d55-1af9-4a7e-8ba0-20d194657a8e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d8953d55-1af9-4a7e-8ba0-20d194657a8e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:267}"
data-executionInfo="{&quot;elapsed&quot;:894,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944181309,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="SjfQS4oFNLl9" data-outputId="afdb0cf5-65cf-40ea-a2bc-6593481d64e8">
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>rm <span class="op">=</span> ratings.pivot(index <span class="op">=</span> <span class="st">&#39;user_id&#39;</span>, columns <span class="op">=</span><span class="st">&#39;movie_id&#39;</span>, values <span class="op">=</span> <span class="st">&#39;rating&#39;</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>rm.astype(<span class="bu">int</span>).head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">

  <div id="df-f627c82c-b97a-45d9-9933-eae77afbc70c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>movie_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>3943</th>
      <th>3944</th>
      <th>3945</th>
      <th>3946</th>
      <th>3947</th>
      <th>3948</th>
      <th>3949</th>
      <th>3950</th>
      <th>3951</th>
      <th>3952</th>
    </tr>
    <tr>
      <th>user_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows  3706 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f627c82c-b97a-45d9-9933-eae77afbc70c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f627c82c-b97a-45d9-9933-eae77afbc70c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f627c82c-b97a-45d9-9933-eae77afbc70c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="75"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:112}"
data-executionInfo="{&quot;elapsed&quot;:55,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944181316,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="jfeZqE9bNLo8" data-outputId="be9ff53d-de75-44c2-fbb3-0a4b0609d881">
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>rm_raw <span class="op">=</span> ratings[[<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;movie_id&#39;</span>, <span class="st">&#39;rating&#39;</span>]].copy()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>rm_raw.columns <span class="op">=</span> [<span class="st">&#39;UserId&#39;</span>, <span class="st">&#39;ItemId&#39;</span>, <span class="st">&#39;Rating&#39;</span>]  <span class="co"># Lib requires specific column names</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>rm_raw.head(<span class="dv">2</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="75">

  <div id="df-f0482e6c-17ea-401b-b71b-a009706e713c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UserId</th>
      <th>ItemId</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f0482e6c-17ea-401b-b71b-a009706e713c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f0482e6c-17ea-401b-b71b-a009706e713c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f0482e6c-17ea-401b-b71b-a009706e713c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="76"
data-executionInfo="{&quot;elapsed&quot;:53,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944181317,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="V-Qh_bOfOTgD">
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cmfrec <span class="im">import</span> CMF</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="77"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:2692,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183961,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Ib3Aq4fLNLsT" data-outputId="33c8cf00-70bc-48f7-e48b-676e0520e1b6">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from cmfrec import CMF</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> CMF(k<span class="op">=</span><span class="dv">3</span>, lambda_<span class="op">=</span><span class="fl">0.1</span>, user_bias<span class="op">=</span><span class="va">False</span>, item_bias<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>model.fit(rm_raw)</span></code></pre></div>
<div class="output execute_result" data-execution_count="77">
<pre><code>Collective matrix factorization model
(explicit-feedback variant)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="78"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:146,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183963,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="nmVET5KaNLuz" data-outputId="026ee250-170b-4590-85d3-e287a0543451">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>model.A_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="78">
<pre><code>(6040, 3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="79"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:131,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183965,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="5CRae9NFNLw0" data-outputId="ee63728d-937a-4ed6-8bc5-29814dd6765d">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>model.B_.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="79">
<pre><code>(3706, 3)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="80"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:103,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183966,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Nzw6G8djNLz5" data-outputId="cf153bd4-c093-4341-b450-06ab55da388d">
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>model.A_</span></code></pre></div>
<div class="output execute_result" data-execution_count="80">
<pre><code>array([[-0.00958391, -0.17743202,  0.16195586],
       [-0.16286132, -0.3025382 , -0.37213776],
       [-0.08792485, -0.22111896, -0.04388591],
       ...,
       [-0.14682147, -0.21881038, -0.24433388],
       [-0.17056152, -0.09411836, -0.11553887],
       [-0.3991945 ,  0.24622837, -0.16886806]], dtype=float32)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="81"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:95,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183970,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="lwkUuYzOeX_5" data-outputId="c708a903-7df7-4a1f-8fdd-818d356be2a4">
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>cmfrec.csr_matrix(model.A_)</span></code></pre></div>
<div class="output execute_result" data-execution_count="81">
<pre><code>&lt;6040x3 sparse matrix of type &#39;&lt;class &#39;numpy.float32&#39;&gt;&#39;
	with 18120 stored elements in Compressed Sparse Row format&gt;</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="82"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:84,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183971,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="HZZzplHfbc0N" data-outputId="1d8e8867-a9a6-420f-8ddd-a22f17d385eb">
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>model.B_</span></code></pre></div>
<div class="output execute_result" data-execution_count="82">
<pre><code>array([[-4.013367  , -1.4335079 ,  1.2978806 ],
       [ 0.27379817, -0.48399982,  2.3520467 ],
       [-1.7438495 , -3.3851151 ,  0.4928088 ],
       ...,
       [ 0.9760184 ,  1.8206757 , -1.9986285 ],
       [-0.37541583, -1.8747995 , -1.0537992 ],
       [-0.6224832 ,  0.10011666,  0.19826597]], dtype=float32)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="83"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:67,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183972,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="MxiiA_c4efa0" data-outputId="2f002be3-3b9d-4d30-e96d-13522baeaea4">
<div class="sourceCode" id="cb111"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>cmfrec.csr_matrix(model.B_)</span></code></pre></div>
<div class="output execute_result" data-execution_count="83">
<pre><code>&lt;3706x3 sparse matrix of type &#39;&lt;class &#39;numpy.float32&#39;&gt;&#39;
	with 11118 stored elements in Compressed Sparse Row format&gt;</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="84"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
data-executionInfo="{&quot;elapsed&quot;:54,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183973,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="tdHN4VY7NL2E" data-outputId="380fa027-0e55-434f-c0b4-41b3bf302804">
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>top_items <span class="op">=</span> model.topN(user<span class="op">=</span><span class="dv">4</span>, n<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>movies.loc[movies.movie_id.isin(top_items)]</span></code></pre></div>
<div class="output execute_result" data-execution_count="84">

  <div id="df-9d3d855c-fcf4-4fa0-af82-b4d1d65ea25d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_id</th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>49</th>
      <td>50</td>
      <td>Usual Suspects, The (1995)</td>
      <td>Crime|Thriller</td>
    </tr>
    <tr>
      <th>52</th>
      <td>53</td>
      <td>Lamerica (1994)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>735</th>
      <td>745</td>
      <td>Close Shave, A (1995)</td>
      <td>Animation|Comedy|Thriller</td>
    </tr>
    <tr>
      <th>740</th>
      <td>750</td>
      <td>Dr. Strangelove or: How I Learned to Stop Worr...</td>
      <td>Sci-Fi|War</td>
    </tr>
    <tr>
      <th>847</th>
      <td>858</td>
      <td>Godfather, The (1972)</td>
      <td>Action|Crime|Drama</td>
    </tr>
    <tr>
      <th>910</th>
      <td>922</td>
      <td>Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)</td>
      <td>Film-Noir</td>
    </tr>
    <tr>
      <th>911</th>
      <td>923</td>
      <td>Citizen Kane (1941)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>2019</td>
      <td>Seven Samurai (The Magnificent Seven) (Shichin...</td>
      <td>Action|Drama</td>
    </tr>
    <tr>
      <th>2836</th>
      <td>2905</td>
      <td>Sanjuro (1962)</td>
      <td>Action|Adventure</td>
    </tr>
    <tr>
      <th>3269</th>
      <td>3338</td>
      <td>For All Mankind (1989)</td>
      <td>Documentary</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9d3d855c-fcf4-4fa0-af82-b4d1d65ea25d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9d3d855c-fcf4-4fa0-af82-b4d1d65ea25d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9d3d855c-fcf4-4fa0-af82-b4d1d65ea25d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="TEQiyGg1UtSK">
<hr />
<h2 id="-evaluation-of-model-using-mse-and-rmse">####
<strong><em>Evaluation of model using mse and rmse</em></strong></h2>
</div>
<div class="cell code" data-execution_count="85"
data-executionInfo="{&quot;elapsed&quot;:52,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944183974,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="OGMhMpAoTUPs">
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error <span class="im">as</span> mse</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_percentage_error <span class="im">as</span> mape</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="86"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:837,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944184760,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="ouXm1TOTNL4r" data-outputId="028e5b41-2ff3-4da8-fbdc-98dcfdd57c44">
<div class="sourceCode" id="cb115"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>rm__ <span class="op">=</span> np.dot(model.A_, model.B_.T) <span class="op">+</span> model.glob_mean_</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>mse(rm.values[rm <span class="op">&gt;</span> <span class="dv">0</span>], rm__[rm <span class="op">&gt;</span> <span class="dv">0</span>])<span class="op">**</span><span class="fl">0.5</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="86">
<pre><code>1.3321351755683746</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="129"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:556,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674946995146,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="VZPaAKOPUmiZ" data-outputId="b83d1277-2aac-440a-90c3-856e5b397d88">
<div class="sourceCode" id="cb117"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(mse(rm.values[rm <span class="op">&gt;</span> <span class="dv">0</span>], rm__[rm <span class="op">&gt;</span> <span class="dv">0</span>]))</span></code></pre></div>
<div class="output execute_result" data-execution_count="129">
<pre><code>1.3321351755683746</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="130"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:530,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674947006303,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="nYngUhXWYz2M" data-outputId="5ded5660-2868-4402-e2ef-fc1a360cb93a">
<div class="sourceCode" id="cb119"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>mape(rm.values[rm <span class="op">&gt;</span> <span class="dv">0</span>], rm__[rm <span class="op">&gt;</span> <span class="dv">0</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="130">
<pre><code>0.3796718211689346</code></pre>
</div>
</div>
<div class="cell markdown" id="GhYSoWn_rCyP">
<hr />
<h2 id="-movie-recommendations-on-the-basis-of-pearson-correlation">####
<strong><em>Movie Recommendations on the basis of pearson
correlation</em></strong></h2>
</div>
<div class="cell code" data-execution_count="89"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:455}"
data-executionInfo="{&quot;elapsed&quot;:846,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186386,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="DQw8tJjFe1C_" data-outputId="8341d2ff-5046-47bc-a80c-3ae529ab56f5">
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> df2.groupby([<span class="st">&#39;movie_id&#39;</span>,<span class="st">&#39;genres&#39;</span>])[<span class="st">&#39;rating&#39;</span>].mean().unstack().reset_index().set_index(<span class="st">&#39;movie_id&#39;</span>).T.fillna(<span class="dv">0</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>correlated_movie_matrix <span class="op">=</span> m1.corr()</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>correlated_movie_matrix</span></code></pre></div>
<div class="output execute_result" data-execution_count="89">

  <div id="df-b879b1b6-cab0-43c2-a17b-a8d7ff9399cb">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>movie_id</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>3943</th>
      <th>3944</th>
      <th>3945</th>
      <th>3946</th>
      <th>3947</th>
      <th>3948</th>
      <th>3949</th>
      <th>3950</th>
      <th>3951</th>
      <th>3952</th>
    </tr>
    <tr>
      <th>movie_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.00</td>
      <td>0.20</td>
      <td>0.31</td>
      <td>0.33</td>
      <td>0.54</td>
      <td>-0.20</td>
      <td>0.30</td>
      <td>0.29</td>
      <td>-0.11</td>
      <td>-0.20</td>
      <td>...</td>
      <td>0.54</td>
      <td>0.22</td>
      <td>0.63</td>
      <td>-0.20</td>
      <td>-0.11</td>
      <td>0.54</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.20</td>
      <td>1.00</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.11</td>
      <td>-0.20</td>
      <td>-0.16</td>
      <td>0.79</td>
      <td>-0.11</td>
      <td>0.20</td>
      <td>...</td>
      <td>-0.11</td>
      <td>-0.15</td>
      <td>0.60</td>
      <td>-0.20</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.31</td>
      <td>-0.16</td>
      <td>1.00</td>
      <td>0.44</td>
      <td>0.67</td>
      <td>-0.16</td>
      <td>1.00</td>
      <td>-0.12</td>
      <td>-0.09</td>
      <td>-0.16</td>
      <td>...</td>
      <td>0.67</td>
      <td>0.31</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.09</td>
      <td>0.67</td>
      <td>-0.09</td>
      <td>-0.09</td>
      <td>-0.09</td>
      <td>-0.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.33</td>
      <td>-0.16</td>
      <td>0.44</td>
      <td>1.00</td>
      <td>0.71</td>
      <td>-0.16</td>
      <td>0.44</td>
      <td>-0.12</td>
      <td>-0.09</td>
      <td>-0.16</td>
      <td>...</td>
      <td>0.71</td>
      <td>0.97</td>
      <td>-0.16</td>
      <td>0.33</td>
      <td>-0.09</td>
      <td>0.71</td>
      <td>0.66</td>
      <td>0.66</td>
      <td>0.66</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.54</td>
      <td>-0.11</td>
      <td>0.67</td>
      <td>0.71</td>
      <td>1.00</td>
      <td>-0.11</td>
      <td>0.67</td>
      <td>-0.09</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>...</td>
      <td>1.00</td>
      <td>0.52</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.06</td>
      <td>1.00</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>-0.09</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3948</th>
      <td>0.54</td>
      <td>-0.11</td>
      <td>0.67</td>
      <td>0.71</td>
      <td>1.00</td>
      <td>-0.11</td>
      <td>0.67</td>
      <td>-0.09</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>...</td>
      <td>1.00</td>
      <td>0.52</td>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.06</td>
      <td>1.00</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>-0.09</td>
    </tr>
    <tr>
      <th>3949</th>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.09</td>
      <td>0.66</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>-0.09</td>
      <td>-0.09</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>...</td>
      <td>-0.06</td>
      <td>0.82</td>
      <td>-0.11</td>
      <td>0.58</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.69</td>
    </tr>
    <tr>
      <th>3950</th>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.09</td>
      <td>0.66</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>-0.09</td>
      <td>-0.09</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>...</td>
      <td>-0.06</td>
      <td>0.82</td>
      <td>-0.11</td>
      <td>0.58</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.69</td>
    </tr>
    <tr>
      <th>3951</th>
      <td>-0.11</td>
      <td>-0.11</td>
      <td>-0.09</td>
      <td>0.66</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>-0.09</td>
      <td>-0.09</td>
      <td>-0.06</td>
      <td>-0.11</td>
      <td>...</td>
      <td>-0.06</td>
      <td>0.82</td>
      <td>-0.11</td>
      <td>0.58</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.69</td>
    </tr>
    <tr>
      <th>3952</th>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.12</td>
      <td>0.42</td>
      <td>-0.09</td>
      <td>0.32</td>
      <td>-0.12</td>
      <td>-0.12</td>
      <td>-0.09</td>
      <td>0.32</td>
      <td>...</td>
      <td>-0.09</td>
      <td>0.54</td>
      <td>-0.16</td>
      <td>0.81</td>
      <td>0.69</td>
      <td>-0.09</td>
      <td>0.69</td>
      <td>0.69</td>
      <td>0.69</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>3428 rows  3428 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b879b1b6-cab0-43c2-a17b-a8d7ff9399cb')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b879b1b6-cab0-43c2-a17b-a8d7ff9399cb button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b879b1b6-cab0-43c2-a17b-a8d7ff9399cb');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="90"
data-executionInfo="{&quot;elapsed&quot;:131,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186388,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="gZJLJkQfrhdS">
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlated_movie_matrix.to_dict()</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="91"
data-executionInfo="{&quot;elapsed&quot;:131,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186389,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="8eKSnlp7e1Fo">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recommend_movie_based_on_correlation(movie):</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    TITLE <span class="op">=</span> movies[movies.title.<span class="bu">str</span>.contains(movie)].iloc[<span class="dv">0</span>][<span class="st">&quot;title&quot;</span>]</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    INDEX <span class="op">=</span> movies[movies.title.<span class="bu">str</span>.contains(movie)].iloc[<span class="dv">0</span>].movie_id</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(TITLE)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(INDEX)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># r = []</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># r.append((movies[movies.movie_id.isin(correlated_movie_matrix[INDEX].sort_values(ascending=False).head(10).index.to_list())][&quot;title&quot;]))</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> movies[movies.movie_id.isin(correlated_movie_matrix[INDEX].sort_values(ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>).index.to_list())][<span class="st">&quot;title&quot;</span>]</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return r</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="92"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:132,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186391,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="9mTwZU07e1K9" data-outputId="37826f3b-8331-489a-8185-b636b5577a65">
<div class="sourceCode" id="cb124"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> recommend_movie_based_on_correlation(<span class="st">&#39;Braveheart&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Braveheart (1995)
110
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="93"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:113,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186393,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="HrSBswL51soy" data-outputId="d2bf82bc-921a-444d-edf0-d83337ce16ff">
<div class="sourceCode" id="cb126"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<div class="output execute_result" data-execution_count="93">
<pre><code>108                Braveheart (1995)
1204        Full Metal Jacket (1987)
1214     Boat, The (Das Boot) (1981)
1222                    Glory (1989)
1545                G.I. Jane (1997)
1959      Saving Private Ryan (1998)
2358       Thin Red Line, The (1998)
3559            Flying Tigers (1942)
3585    Guns of Navarone, The (1961)
3684             Patriot, The (2000)
Name: title, dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="94"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:91,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186394,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Wxm4u7Zcpdbu" data-outputId="6b8391df-5896-4657-a659-6a7c14c560e9">
<div class="sourceCode" id="cb128"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(recommend_movie_based_on_correlation(<span class="st">&#39;Toy Story&#39;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Toy Story (1995)
1
</code></pre>
</div>
<div class="output execute_result" data-execution_count="94">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="95"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:78,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186395,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="GFnzIMG_Uqnj" data-outputId="da28d507-8961-4d02-8786-90015a1cf08b">
<div class="sourceCode" id="cb131"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>recommend_movie_based_on_correlation(<span class="st">&#39;Toy Story&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Toy Story (1995)
1
</code></pre>
</div>
<div class="output execute_result" data-execution_count="95">
<pre><code>0                                     Toy Story (1995)
1050            Aladdin and the King of Thieves (1996)
2033                           Steamboat Willie (1940)
2072                          American Tail, An (1986)
2073        American Tail: Fievel Goes West, An (1991)
2285                         Rugrats Movie, The (1998)
2286                              Bug&#39;s Life, A (1998)
3542                             Saludos Amigos (1943)
3682                                Chicken Run (2000)
3685    Adventures of Rocky and Bullwinkle, The (2000)
Name: title, dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="96"
data-executionInfo="{&quot;elapsed&quot;:66,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186396,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="db7Egpr2pn3d">
<div class="sourceCode" id="cb134"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recommend_movie_based_on_correlation(&#39;Gladiator&#39;)</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="97"
data-executionInfo="{&quot;elapsed&quot;:34,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186397,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="9zls8ChohT-i">
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="98"
data-executionInfo="{&quot;elapsed&quot;:35,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186399,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="Qwn1hvG1hXML">
<div class="sourceCode" id="cb136"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pickle.dump(movies,<span class="bu">open</span>(<span class="st">&#39;movie.pkl&#39;</span>,<span class="st">&#39;wb&#39;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="99"
data-executionInfo="{&quot;elapsed&quot;:631,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186997,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="XeC68EdikvIf">
<div class="sourceCode" id="cb137"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp .<span class="op">/</span>movie.pkl <span class="op">/</span>content<span class="op">/</span>drive<span class="op">/</span>MyDrive<span class="op">/</span>Scaler<span class="op">/</span>datasets</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="100"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:16,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944186998,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="6MKyfWganNKt" data-outputId="e077bb0e-bdca-4566-9cf4-81a3f05827dd">
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>movies.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="100">

  <div id="df-9d86ac8a-c254-4194-9b2d-3ced47279f63">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_id</th>
      <th>title</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9d86ac8a-c254-4194-9b2d-3ced47279f63')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9d86ac8a-c254-4194-9b2d-3ced47279f63 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9d86ac8a-c254-4194-9b2d-3ced47279f63');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="101"
data-executionInfo="{&quot;elapsed&quot;:14,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944187000,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="uPyMcsecntDK">
<div class="sourceCode" id="cb139"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>pickle.dump(movies.to_dict(),<span class="bu">open</span>(<span class="st">&#39;movie_dict.pkl&#39;</span>,<span class="st">&#39;wb&#39;</span>))</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp .<span class="op">/</span>movie_dict.pkl <span class="op">/</span>content<span class="op">/</span>drive<span class="op">/</span>MyDrive<span class="op">/</span>Scaler<span class="op">/</span>datasets</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="102"
data-executionInfo="{&quot;elapsed&quot;:14043,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944201031,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="fjyqsOhFsI_l">
<div class="sourceCode" id="cb140"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>pickle.dump(correlated_movie_matrix.to_dict(),<span class="bu">open</span>(<span class="st">&#39;correlated_movie_matrix.pkl&#39;</span>,<span class="st">&#39;wb&#39;</span>))</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp .<span class="op">/</span>correlated_movie_matrix.pkl <span class="op">/</span>content<span class="op">/</span>drive<span class="op">/</span>MyDrive<span class="op">/</span>Scaler<span class="op">/</span>datasets</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="103"
data-executionInfo="{&quot;elapsed&quot;:3083,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944204066,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="5NbpVHsJ43Y3">
<div class="sourceCode" id="cb141"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>pickle.dump(df2[[<span class="st">&#39;title&#39;</span>]].to_dict(),<span class="bu">open</span>(<span class="st">&#39;titles_.pkl&#39;</span>,<span class="st">&#39;wb&#39;</span>))</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp .<span class="op">/</span>titles_.pkl <span class="op">/</span>content<span class="op">/</span>drive<span class="op">/</span>MyDrive<span class="op">/</span>Scaler<span class="op">/</span>datasets</span></code></pre></div>
</div>
<section id="---" class="cell markdown" id="WoEZScl2yRXr">
<h2>---</h2>
<h3
id="users-of-which-age-group-have-watched-and-rated-the-most-number-of-movies">Users
of which age group have watched and rated the most number of
movies?</h3>
</section>
<div class="cell code" data-execution_count="104"
data-executionInfo="{&quot;elapsed&quot;:103,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944204070,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="BGGlN1ISe0ef">
<div class="sourceCode" id="cb142"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="op">=</span> df2[[<span class="st">&#39;user_id&#39;</span>,<span class="st">&#39;age&#39;</span>,<span class="st">&#39;rating&#39;</span>,<span class="st">&#39;movie_id&#39;</span>]].reset_index().drop([<span class="st">&#39;index&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="105"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:431}"
data-executionInfo="{&quot;elapsed&quot;:101,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944204071,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="yehwY3Ooe0hg" data-outputId="44d4cb61-2ff0-43b6-db6a-b380e70bd162">
<div class="sourceCode" id="cb143"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most ratings by an agegroup</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>Q1.groupby([<span class="st">&#39;age&#39;</span>])[<span class="st">&#39;rating&#39;</span>].count().sort_values(ascending<span class="op">=</span><span class="va">False</span>).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Most ratings by an age-group&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>WARNING:matplotlib.font_manager:findfont: Font family [&#39;Comic Sans MS&#39;] not found. Falling back to DejaVu Sans.
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/201a7a51d263ef59f71f5e04845cc1a8464c3557.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="106"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:414}"
data-executionInfo="{&quot;elapsed&quot;:1135,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944205137,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="6MEsj5YokOmw" data-outputId="7ab5e29b-fc5b-4645-ec69-63183a43692c">
<div class="sourceCode" id="cb145"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age group that watched  the most number of movies</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>Q1.groupby([<span class="st">&#39;age&#39;</span>])[<span class="st">&#39;movie_id&#39;</span>].nunique().sort_values(ascending<span class="op">=</span><span class="va">False</span>).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Age group that watched  the most number of movies&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/36d2872dacb287f5f09d78d70d3c9217daa84cde.png" /></p>
</div>
</div>
<section id="---" class="cell markdown" id="JRY0yspqyDDj">
<h2>---</h2>
<h3
id="users-belonging-to-which-profession-have-watched-and-rated-the-most-movies">Users
belonging to which profession have watched and rated the most
movies?</h3>
</section>
<div class="cell code" data-execution_count="107"
data-executionInfo="{&quot;elapsed&quot;:18,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944205145,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="WXjv5KA1_Azz">
<div class="sourceCode" id="cb146"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>mapit <span class="op">=</span> {<span class="dv">0</span>: <span class="st">&quot;other&quot;</span>, <span class="dv">1</span>: <span class="st">&quot;academic/educator&quot;</span> ,<span class="dv">2</span>: <span class="st">&quot;artist&quot;</span> ,<span class="dv">3</span>: <span class="st">&quot;clerical/admin&quot;</span> ,<span class="dv">4</span>: <span class="st">&quot;college/grad student&quot;</span> ,<span class="dv">5</span>: <span class="st">&quot;customer service&quot;</span> ,<span class="dv">6</span>: <span class="st">&quot;doctor/health care&quot;</span> ,<span class="dv">7</span>: <span class="st">&quot;executive/managerial&quot;</span> ,<span class="dv">8</span>: <span class="st">&quot;farmer&quot;</span> ,<span class="dv">9</span>: <span class="st">&quot;homemaker&quot;</span> ,<span class="dv">10</span>: <span class="st">&quot;K-12 student&quot;</span> ,<span class="dv">11</span>: <span class="st">&quot;lawyer&quot;</span> ,<span class="dv">12</span>: <span class="st">&quot;programmer&quot;</span> ,<span class="dv">13</span>: <span class="st">&quot;retired&quot;</span> ,<span class="dv">14</span>: <span class="st">&quot;sales/marketing&quot;</span> ,<span class="dv">15</span>: <span class="st">&quot;scientist&quot;</span> ,<span class="dv">16</span>: <span class="st">&quot;self-employed&quot;</span> ,<span class="dv">17</span>: <span class="st">&quot;technician/engineer&quot;</span> ,<span class="dv">18</span>: <span class="st">&quot;tradesman/craftsman&quot;</span> ,<span class="dv">19</span>: <span class="st">&quot;unemployed&quot;</span>, <span class="dv">20</span>: <span class="st">&quot;writer&quot;</span>}</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>df3[<span class="st">&#39;occupation&#39;</span>] <span class="op">=</span> df3[<span class="st">&#39;occupation&#39;</span>].<span class="bu">map</span>(mapit)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="108"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:547}"
data-executionInfo="{&quot;elapsed&quot;:1677,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944206805,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="_juXFt44v5Oi" data-outputId="1d4d136e-a2b2-4d09-a555-3889b75b8285">
<div class="sourceCode" id="cb147"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most ratings by an agegroup</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>df3.groupby([<span class="st">&#39;occupation&#39;</span>])[<span class="st">&#39;rating&#39;</span>].count().sort_values(ascending<span class="op">=</span><span class="va">False</span>).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39; Users belonging to which profession have rated the most movies&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/f4e9c41e543b82f9b788d7aea314cf1a5c149b03.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="109"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:468}"
data-executionInfo="{&quot;elapsed&quot;:52,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944206806,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="4OyK154IBTQx" data-outputId="18feeda5-8d75-441d-daee-91bffdec2a6a">
<div class="sourceCode" id="cb148"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>df3</span></code></pre></div>
<div class="output execute_result" data-execution_count="109">

  <div id="df-7c5ad5b9-b291-4732-b757-02d1a4e7f98f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>115541</th>
      <td>4956</td>
      <td>1084</td>
      <td>4</td>
      <td>962638726</td>
      <td>2000-03-07</td>
      <td>15</td>
      <td>M</td>
      <td>35</td>
      <td>scientist</td>
      <td>77007</td>
      <td>Bonnie and Clyde</td>
      <td>Drama</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>361393</th>
      <td>1873</td>
      <td>3155</td>
      <td>4</td>
      <td>974740115</td>
      <td>2000-11-20</td>
      <td>17</td>
      <td>M</td>
      <td>35</td>
      <td>executive/managerial</td>
      <td>2127</td>
      <td>Anna and the King</td>
      <td>Romance</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>6098</th>
      <td>502</td>
      <td>1197</td>
      <td>5</td>
      <td>976210655</td>
      <td>2000-07-12</td>
      <td>17</td>
      <td>M</td>
      <td>35</td>
      <td>doctor/health care</td>
      <td>55126</td>
      <td>Princess Bride, The</td>
      <td>Adventure</td>
      <td>1987</td>
    </tr>
    <tr>
      <th>792171</th>
      <td>3441</td>
      <td>122</td>
      <td>2</td>
      <td>967308615</td>
      <td>2000-08-26</td>
      <td>16</td>
      <td>F</td>
      <td>25</td>
      <td>sales/marketing</td>
      <td>94109</td>
      <td>Boomerang</td>
      <td>Comedy</td>
      <td>1992</td>
    </tr>
    <tr>
      <th>473069</th>
      <td>193</td>
      <td>1374</td>
      <td>3</td>
      <td>1035342850</td>
      <td>2002-10-23</td>
      <td>3</td>
      <td>F</td>
      <td>45</td>
      <td>scientist</td>
      <td>44106</td>
      <td>Star Trek: The Wrath of Khan</td>
      <td>Sci-Fi</td>
      <td>1982</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>263553</th>
      <td>1944</td>
      <td>1127</td>
      <td>5</td>
      <td>974692037</td>
      <td>2000-11-20</td>
      <td>3</td>
      <td>F</td>
      <td>18</td>
      <td>college/grad student</td>
      <td>93107</td>
      <td>Abyss, The</td>
      <td>Adventure</td>
      <td>1989</td>
    </tr>
    <tr>
      <th>865084</th>
      <td>2106</td>
      <td>2491</td>
      <td>2</td>
      <td>975439895</td>
      <td>2000-11-28</td>
      <td>19</td>
      <td>F</td>
      <td>18</td>
      <td>writer</td>
      <td>495321</td>
      <td>Simply Irresistible</td>
      <td>Comedy</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>274216</th>
      <td>2581</td>
      <td>3744</td>
      <td>3</td>
      <td>974065088</td>
      <td>2000-12-11</td>
      <td>21</td>
      <td>M</td>
      <td>25</td>
      <td>lawyer</td>
      <td>60611</td>
      <td>Shaft</td>
      <td>Crime</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>869660</th>
      <td>1755</td>
      <td>2443</td>
      <td>3</td>
      <td>1037947827</td>
      <td>2002-11-22</td>
      <td>6</td>
      <td>F</td>
      <td>18</td>
      <td>college/grad student</td>
      <td>77005</td>
      <td>Playing by Heart</td>
      <td>Romance</td>
      <td>1998</td>
    </tr>
    <tr>
      <th>669903</th>
      <td>2567</td>
      <td>3635</td>
      <td>3</td>
      <td>973958742</td>
      <td>2000-11-11</td>
      <td>16</td>
      <td>M</td>
      <td>25</td>
      <td>other</td>
      <td>6451</td>
      <td>Spy Who Loved Me, The</td>
      <td>Action</td>
      <td>1977</td>
    </tr>
  </tbody>
</table>
<p>1000000 rows  13 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7c5ad5b9-b291-4732-b757-02d1a4e7f98f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7c5ad5b9-b291-4732-b757-02d1a4e7f98f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7c5ad5b9-b291-4732-b757-02d1a4e7f98f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="110"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:547}"
data-executionInfo="{&quot;elapsed&quot;:48,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944206808,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="OgBhxV9Kv5RP" data-outputId="ac7b3ef5-c18f-468c-9eeb-e87385dacfc4">
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age group that watched  the most number of movies</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>df3.groupby([<span class="st">&#39;occupation&#39;</span>])[<span class="st">&#39;movie_id&#39;</span>].nunique().sort_values(ascending<span class="op">=</span><span class="va">False</span>).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39; Users belonging to which profession have watched the most movies&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/48d59a890b957cfe85551533edfe02cedba3ac2f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="111"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:250}"
data-executionInfo="{&quot;elapsed&quot;:47,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944206811,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="KZbksXZWv5UN" data-outputId="a4bccd69-624d-4ef7-a4ac-9d1eb049f5ba">
<div class="sourceCode" id="cb150"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>df3.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="111">

  <div id="df-2a6fe12f-4e41-44f7-8eb5-e80067cbac6c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>date</th>
      <th>hours</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zip_code</th>
      <th>title</th>
      <th>genres</th>
      <th>release_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>115541</th>
      <td>4956</td>
      <td>1084</td>
      <td>4</td>
      <td>962638726</td>
      <td>2000-03-07</td>
      <td>15</td>
      <td>M</td>
      <td>35</td>
      <td>scientist</td>
      <td>77007</td>
      <td>Bonnie and Clyde</td>
      <td>Drama</td>
      <td>1967</td>
    </tr>
    <tr>
      <th>361393</th>
      <td>1873</td>
      <td>3155</td>
      <td>4</td>
      <td>974740115</td>
      <td>2000-11-20</td>
      <td>17</td>
      <td>M</td>
      <td>35</td>
      <td>executive/managerial</td>
      <td>2127</td>
      <td>Anna and the King</td>
      <td>Romance</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>6098</th>
      <td>502</td>
      <td>1197</td>
      <td>5</td>
      <td>976210655</td>
      <td>2000-07-12</td>
      <td>17</td>
      <td>M</td>
      <td>35</td>
      <td>doctor/health care</td>
      <td>55126</td>
      <td>Princess Bride, The</td>
      <td>Adventure</td>
      <td>1987</td>
    </tr>
    <tr>
      <th>792171</th>
      <td>3441</td>
      <td>122</td>
      <td>2</td>
      <td>967308615</td>
      <td>2000-08-26</td>
      <td>16</td>
      <td>F</td>
      <td>25</td>
      <td>sales/marketing</td>
      <td>94109</td>
      <td>Boomerang</td>
      <td>Comedy</td>
      <td>1992</td>
    </tr>
    <tr>
      <th>473069</th>
      <td>193</td>
      <td>1374</td>
      <td>3</td>
      <td>1035342850</td>
      <td>2002-10-23</td>
      <td>3</td>
      <td>F</td>
      <td>45</td>
      <td>scientist</td>
      <td>44106</td>
      <td>Star Trek: The Wrath of Khan</td>
      <td>Sci-Fi</td>
      <td>1982</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-2a6fe12f-4e41-44f7-8eb5-e80067cbac6c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-2a6fe12f-4e41-44f7-8eb5-e80067cbac6c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-2a6fe12f-4e41-44f7-8eb5-e80067cbac6c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="---" class="cell markdown" id="7M84dHmqylwC">
<h2>---</h2>
<h3
id="most-of-the-users-in-our-dataset-whove-rated-the-movies-are-male-tf">Most
of the users in our dataset whove rated the movies are Male. (T/F)</h3>
</section>
<div class="cell code" data-execution_count="112"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:408}"
data-executionInfo="{&quot;elapsed&quot;:1890,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944208664,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="0qWd-PnjELKC" data-outputId="ca1f1e80-8e0a-467b-fa3c-f943e7c5c600">
<div class="sourceCode" id="cb151"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>df3.groupby([<span class="st">&#39;gender&#39;</span>])[<span class="st">&#39;rating&#39;</span>].count().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39; Most users whove rated the movies are Male is a true statement&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/0b0616cd0e6512f75cdc6483e0a3e841570a5d65.png" /></p>
</div>
</div>
<section id="---" class="cell markdown" id="Lun_s9mNE0MF">
<h2>---</h2>
<h3
id="most-of-the-movies-present-in-our-dataset-were-released-in-which-decade">Most
of the movies present in our dataset were released in which decade?</h3>
<p><code>70s b. 90s c. 50s d.80s</code></p>
</section>
<div class="cell code" data-execution_count="113"
data-executionInfo="{&quot;elapsed&quot;:268,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944208665,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="KvGWIn4CfER8">
<div class="sourceCode" id="cb152"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> df3.groupby([<span class="st">&#39;release_year&#39;</span>])[<span class="st">&#39;movie_id&#39;</span>].nunique().sort_values(ascending<span class="op">=</span><span class="va">False</span>).reset_index()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="114"
data-executionInfo="{&quot;elapsed&quot;:268,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944208667,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="6APLlKZ2E9G1">
<div class="sourceCode" id="cb153"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">1920</span>,<span class="dv">1930</span>,<span class="dv">1940</span>,<span class="dv">1950</span>,<span class="dv">1960</span>,<span class="dv">1970</span>,<span class="dv">1980</span>,<span class="dv">1990</span>,<span class="dv">2000</span>,<span class="dv">2010</span>]</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> [<span class="st">&#39;20s&#39;</span>,<span class="st">&#39;30s&#39;</span>,<span class="st">&#39;40s&#39;</span>,<span class="st">&#39;50s&#39;</span>,<span class="st">&#39;60s&#39;</span>,<span class="st">&#39;70s&#39;</span>,<span class="st">&#39;80s&#39;</span>,<span class="st">&#39;90s&#39;</span>,<span class="st">&#39;100s&#39;</span>]</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>n[<span class="st">&#39;release_year_&#39;</span>] <span class="op">=</span> pd.cut(n[<span class="st">&#39;release_year&#39;</span>],bins,labels<span class="op">=</span>label)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="115"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}"
data-executionInfo="{&quot;elapsed&quot;:254,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674944208668,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="UehJMVT_E9M2" data-outputId="5d211433-e661-4b0a-80f2-71f6157471fc">
<div class="sourceCode" id="cb154"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>n.groupby(<span class="st">&#39;release_year_&#39;</span>)[<span class="st">&#39;movie_id&#39;</span>].<span class="bu">sum</span>().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Decade with highest movies releases&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/8779dcdd278e0f048be936ebaceb3ec060749756.png" /></p>
</div>
</div>
<section id="---" class="cell markdown" id="eByu5YKhi9D0">
<h2>---</h2>
<h3 id="the-movie-with-maximum-no-of-ratings-is-___">The movie with
maximum no. of ratings is ___.</h3>
</section>
<div class="cell code" data-execution_count="125"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:728}"
data-executionInfo="{&quot;elapsed&quot;:1826,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674945730505,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="i4xDI4miiANx" data-outputId="fa58511a-d13e-435e-a428-4d5699474981">
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>df3.groupby(<span class="st">&quot;title&quot;</span>)[<span class="st">&quot;rating&quot;</span>].count().reset_index().sort_values(by<span class="op">=</span><span class="st">&quot;rating&quot;</span>,ascending<span class="op">=</span><span class="va">False</span>).set_index(<span class="st">&#39;title&#39;</span>).head(<span class="dv">10</span>).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;TOP 10 movies with most number of ratings&#39;</span>,fontsize<span class="op">=</span><span class="dv">12</span>,fontname<span class="op">=</span><span class="st">&#39;Comic Sans MS&#39;</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_413f0ba513c64fc39457fe7a0d3deb24/735c3ddf718daadc5a1d9cb1d9af400c103ae1f5.png" /></p>
</div>
</div>
<section id="---" class="cell markdown" id="uRnLSKeFjRbM">
<h2>---</h2>
<h3
id="name-the-top-3-movies-similar-to-liar-liar-on-the-item-based-approach">Name
the top 3 movies similar to Liar Liar on the item-based approach.</h3>
</section>
<div class="cell code" data-execution_count="128"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:539,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674945926114,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="_eoIUzqTiAEZ" data-outputId="aba3f417-208d-4e98-b09d-b32c7ead6734">
<div class="sourceCode" id="cb156"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>recommend_movie_based_on_correlation(<span class="st">&#39;Liar Liar&#39;</span>)[:<span class="dv">3</span>]</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Liar Liar (1997)
1485
</code></pre>
</div>
<div class="output execute_result" data-execution_count="128">
<pre><code>117    Steal Big, Steal Little (1995)
407               You So Crazy (1994)
658                   Faithful (1996)
Name: title, dtype: object</code></pre>
</div>
</div>
<section id="---" class="cell markdown" id="iVdAFgO2mbhx">
<h2>---</h2>
<h3
id="on-the-basis-of-approach-collaborative-filtering-methods-can-be-classified-into--based-and--based">On
the basis of approach, Collaborative Filtering methods can be classified
into <strong><em>-based and </em></strong>-based.</h3>
</section>
<div class="cell markdown" id="nQ6Ggg_mmjHR">
<p><strong><em>ITEM-ITEM BASED AND USER-USER BASED</em></strong></p>
</div>
<section id="---" class="cell markdown" id="kB5qPiWEnTDW">
<h2>---</h2>
<h3
id="pearson-correlation-ranges-between-___-to-___-whereas-cosine-similarity-belongs-to-the-interval-between-___-to-___">Pearson
Correlation ranges between ___ to ___ whereas, Cosine Similarity belongs
to the interval between ___ to ___.</h3>
</section>
<div class="cell markdown" id="aiB9tRlYnQLN">
<p><strong><em>Pearson Correlation ranges from -1 to 1, whereas Cosine
Similarity ranges from 0 to 1.</em></strong></p>
</div>
<section id="---" class="cell markdown" id="cTA5viq_naVN">
<h2>---</h2>
<h3
id="mention-the-rmse-and-mape-that-you-got-while-evaluating-the-matrix-factorization-model">Mention
the RMSE and MAPE that you got while evaluating the Matrix Factorization
model.</h3>
</section>
<div class="cell code" data-execution_count="131"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:1264,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674947064802,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="1l3sPU_aiAY3" data-outputId="611c9151-5e44-4e1d-aeb3-5f6dca21fa4d">
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;MAPE : &#39;</span>,mape(rm.values[rm <span class="op">&gt;</span> <span class="dv">0</span>], rm__[rm <span class="op">&gt;</span> <span class="dv">0</span>]),<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;RMSE :&#39;</span>,np.sqrt(mse(rm.values[rm <span class="op">&gt;</span> <span class="dv">0</span>], rm__[rm <span class="op">&gt;</span> <span class="dv">0</span>])))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>MAPE :  0.3796718211689346 

RMSE : 1.3321351755683746
</code></pre>
</div>
</div>
<section id="---" class="cell markdown" id="F8zJp-bZoNGq">
<h2>---</h2>
<h3
id="give-the-sparse-row-matrix-representation-for-the-following-dense-matrix--">Give
the sparse row matrix representation for the following dense matrix
-</h3>
<p>[[1 0] [3 7]]</p>
</section>
<div class="cell code" data-execution_count="132"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:569,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674947197021,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="e1KCErI8iAmX" data-outputId="bca13c19-2e0b-4185-abb7-f79224309ac4">
<div class="sourceCode" id="cb161"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse <span class="im">import</span> coo_matrix</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>dense_matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">3</span>, <span class="dv">7</span>]])</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>sparse_matrix <span class="op">=</span> coo_matrix(dense_matrix)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sparse_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  (0, 0)	1
  (1, 0)	3
  (1, 1)	7
</code></pre>
</div>
</div>
<div class="cell code" id="fFYT9DmsiAuK">
<div class="sourceCode" id="cb163"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="---" class="cell markdown" id="YQS5gxaMo4ma">
<h2>---</h2>
<h3 id="5-top-rated-recommended-movies-as-per-age-">5 Top rated
Recommended Movies as per age :</h3>
</section>
<div class="cell code" data-execution_count="142"
data-executionInfo="{&quot;elapsed&quot;:524,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674947643171,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="zBEe9eA9qGdc">
<div class="sourceCode" id="cb164"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>age_groups <span class="op">=</span> df3.age.unique()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="143"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
data-executionInfo="{&quot;elapsed&quot;:2614,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1674947671548,&quot;user&quot;:{&quot;displayName&quot;:&quot;Bishal Roy&quot;,&quot;userId&quot;:&quot;00016471244271782514&quot;},&quot;user_tz&quot;:-330}"
id="kLz46kzrqGoi" data-outputId="164b3065-1fe1-465a-8d8d-81499d3b0bf9">
<div class="sourceCode" id="cb165"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> age_ <span class="kw">in</span> age_groups:</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(age_)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;------&quot;</span>)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(df3[df3.age <span class="op">==</span> age_].groupby(<span class="st">&quot;title&quot;</span>)[<span class="st">&quot;rating&quot;</span>].count().sort_values(ascending<span class="op">=</span><span class="va">False</span>).head())</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>()</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>()</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>35
------
title
Star Wars: Episode V - The Empire Strikes Back     1539
Star Wars: Episode VI - Return of the Jedi         1381
Star Wars: Episode IV - A New Hope                 1269
Men in Black                                       1008
E.T. the Extra-Terrestrial                          967
Name: rating, dtype: int64



25
------
title
Star Wars: Episode V - The Empire Strikes Back     2975
Star Wars: Episode VI - Return of the Jedi         2932
Star Wars: Episode IV - A New Hope                 2318
Princess Bride, The                                2008
Men in Black                                       1972
Name: rating, dtype: int64



45
------
title
Star Wars: Episode V - The Empire Strikes Back     568
Star Wars: Episode VI - Return of the Jedi         545
Star Wars: Episode IV - A New Hope                 485
E.T. the Extra-Terrestrial                         406
L.A. Confidential                                  399
Name: rating, dtype: int64



18
------
title
Star Wars: Episode VI - Return of the Jedi         1513
Star Wars: Episode V - The Empire Strikes Back     1468
Star Wars: Episode IV - A New Hope                 1171
Star Wars: Episode I - The Phantom Menace          1065
Men in Black                                       1005
Name: rating, dtype: int64



56
------
title
Star Wars: Episode V - The Empire Strikes Back     289
Star Wars: Episode VI - Return of the Jedi         259
L.A. Confidential                                  258
Star Wars: Episode IV - A New Hope                 237
African Queen, The                                 202
Name: rating, dtype: int64



50
------
title
Star Wars: Episode V - The Empire Strikes Back     543
Star Wars: Episode VI - Return of the Jedi         516
Star Wars: Episode IV - A New Hope                 440
Men in Black                                       391
L.A. Confidential                                  382
Name: rating, dtype: int64



</code></pre>
</div>
</div>
<div class="cell code" id="2DSmKddErVDI">
<div class="sourceCode" id="cb167"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell markdown" id="n4bMg_hRr03n">
<h2 id="---">---</h2>
<h2 id="-questions-and-answers-"># Questions and Answers :</h2>
<hr />
<h4
id="1-users-of-which-age-group-have-watched-and-rated-the-most-number-of-movies">1)
Users of which age group have watched and rated the most number of
movies?</h4>
<ul>
<li><strong>age group 25-35</strong></li>
</ul>
<h4
id="2-users-belonging-to-which-profession-have-watched-and-rated-the-most-movies">2)
Users belonging to which profession have watched and rated the most
movies?</h4>
<ul>
<li><strong>College Graduate Students and Other category</strong></li>
</ul>
<h4
id="3-most-of-the-users-in-our-dataset-whove-rated-the-movies-are-male-tf">3)
Most of the users in our dataset whove rated the movies are Male.
(T/F)</h4>
<ul>
<li><strong>Male(True)</strong></li>
</ul>
<h4
id="4-most-of-the-movies-present-in-our-dataset-were-released-in-which-decade">4)
Most of the movies present in our dataset were released in which
decade?</h4>
<ul>
<li><strong>90s</strong></li>
</ul>
<h4 id="5-the-movie-with-maximum-no-of-ratings-is-___">5) The movie with
maximum no. of ratings is ___.</h4>
<ul>
<li><strong>Star Wars: Episode V - The Empire Strikes Back</strong></li>
</ul>
<h4
id="6-name-the-top-3-movies-similar-to-liar-liar-on-the-item-based-approach">6)
Name the top 3 movies similar to Liar Liar on the item-based
approach.</h4>
<ul>
<li><p><strong>Steal Big, Steal Little (1995)</strong></p></li>
<li><p><strong>You So Crazy (1994)</strong></p></li>
<li><p><strong>Faithful (1996)</strong></p></li>
</ul>
<h4
id="7-on-the-basis-of-approach-collaborative-filtering-methods-can-be-classified-into--based-and--based">7)
On the basis of approach, Collaborative Filtering methods can be
classified into <strong><em>-based and </em></strong>-based.</h4>
<ul>
<li><strong>item and User</strong></li>
</ul>
<h2
id="-8-pearson-correlation-ranges-between-___-to-___-whereas-cosine-similarity-belongs-to-the-interval-between-___-to-___">####
8) Pearson Correlation ranges between ___ to ___ whereas, Cosine
Similarity belongs to the interval between ___ to ___.</h2>
<p><strong>Pearson Correlation ranges between -1 to +1</strong></p>
<ul>
<li><strong>Cosine Similarity belongs to the interval between 0 to
1</strong></li>
</ul>
<h4
id="9-mention-the-rmse-and-mape-that-you-got-while-evaluating-the-matrix-factorization-model">9)
Mention the RMSE and MAPE that you got while evaluating the Matrix
Factorization model.</h4>
<p><strong>User-based Model :</strong></p>
<ul>
<li><p>MAPE : 0.3796718211689346</p></li>
<li><p>RMSE : 1.3321351755683746</p></li>
</ul>
<h4
id="10-give-the-sparse-row-matrix-representation-for-the-following-dense-matrix--">10)
Give the sparse row matrix representation for the following dense
matrix -</h4>
<p><strong>[[1 0],[3 7]]</strong></p>
<ul>
<li>ans : (0, 0) 1 (1, 0) 3 (1, 1) 7</li>
</ul>
</div>
<section id="---" class="cell markdown" id="qMQx4mMIuo02">
<h2>---</h2>
</section>
</body>
</html>
